{% load static %}
<!DOCTYPE html>
<html lang="">
<head>
    <title>Site Walkdown</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <script src="{% static 'OTRisk/jquery-gauge.js' %}"></script>
    <script src="{% static 'OTRisk/jquery-gauge.min.js' %}"></script>
    <script src="{% static 'OTRisk/walkdown_print.js' %}"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="{% static 'css/jquery-gauge.css' %}" rel="stylesheet">
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Function to save the walkdown questionnaire
        function saveWalkdownQuestionnaire() {
            // Get the question IDs and user responses
            var questionIDs = [];
            var userResponses = [];
            var questions = [];

            // Loop through each question
            {% for category in question_categories %}
                {% for question in walkdown_questions|dictsort:'Category' %}
                    {% if question.Category == category %}
                        var questionID = {{ question.ID }};
                        var questiontext = JSON.stringify("{{ question.WalkdownQuestion }}");
                        var inputElement = document.querySelector('input[name="response-' + questionID + '"]:checked');
                        var userResponse = inputElement ? inputElement.value : '';

                        questionIDs.push(questionID);
                        questions.push(questiontext);
                        userResponses.push(userResponse);
                    {% endif %}
                {% endfor %}
            {% endfor %}

            // Get the walkdownID and action_cyberPHA from sessionStorage
            var walkdownid = sessionStorage.getItem('walkdownid');
            var activecyberpha = sessionStorage.getItem('active-cyberpha');

            // Create the payload data
            var data = {
                'walkdownid': walkdownid,
                'activecyberpha': activecyberpha,
                'question_ids[]': questionIDs,
                'question_texts[]': questions,
                'user_responses[]': userResponses
            };

            // Send the data to the server
            fetch("{% url 'OTRisk:save_walkdown_questionnaire' %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                body: new URLSearchParams(data)
            })
            .then(response => response.json())
            .then(response => {
                if (response.success) {
                    // Success message
                    console.log('Questionnaire saved successfully');
                } else {
                    // Error message
                    console.log('Error: ' + response.message);
                }
            })
            .catch(error => {
                // Error handling
                console.log('Error: ' + error);
            });
        }

        // Event listener for saving the walkdown questionnaire
        document.getElementById('save-walkdown-questionnaire-btn').addEventListener('click', function() {
            saveWalkdownQuestionnaire();
        });


            // Event listener for saving the walkdown questionnaire
            document.getElementById('save-walkdown-questionnaire-btn').addEventListener('click', function() {
                saveWalkdownQuestionnaire();
            });
        });

    </script>


    <style>
   .small-font {
        font-size: 0.8rem; /* adjust as needed */
   }

    .navbar-scroll .nav-link,
    .navbar-scroll .navbar-toggler-icon,
    .navbar-scroll .navbar-brand {
      color: #ffffff;
    }

    /* Color of the navbar BEFORE scroll */
    .navbar-scroll {
      background-color: #000000;
        text-decoration-color: #FFFFFF;
    }


    /* Color of the links AFTER scroll */
    .navbar-scrolled .nav-link,
    .navbar-scrolled .navbar-toggler-icon,
    .navbar-scroll .navbar-brand {
      color: #262626;
    }

    .navbar-logo {
    position: absolute;
    top: 5px; /* Adjust this as needed */
    left: 5; /* Adjust this as needed */
    height: 100px; /* Adjust this as needed */
    z-index: 10;
}



      .link-primary {
        color: #007bff;
        text-decoration: underline;
        cursor: pointer;
      }

.table-container {
  max-height: 600px; /* Adjust the height as needed */
  overflow: auto;
}
.word-wrap {
  word-wrap: break-word;
}
.progress-text {
  position: relative;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 12px;
  font-weight: normal;
  color: black;
  white-space: nowrap;
}


</style>

</head>
<body>

<nav class="navbar navbar-expand-lg navbar-scroll fixed-top shadow-0 border-bottom border-dark rounded">
  <div class="container-fluid d-flex justify-content-between">
   <a class="navbar-brand" href="{% url 'OTRisk:dashboardhome' %}"><img src="/static/images/logo1-2.jpg" style="height: 140px; width: 140px" class="navbar-logo" alt="">  </a>
      <h4 class="my-auto text-center flex-grow-1"><font color="white">Facility Walkdown and Visual Inspection</font></h4>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto">

        <li class="nav-item">
          <a class="nav-link" href="{% url 'OTRisk:qraw' %}"><i class="bi bi-journal-text"></i> Risk Assessment</a>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-diagram-3"></i> CyberPHA
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="{% url 'OTRisk:iotaphamanager' %}"> CyberPHA Manager</a></li>
                <li><a class="dropdown-item" href="{% url 'OTRisk:walkdown' %}"> Site Walkdown</a></li>
                <li><a class="dropdown-item" href="#">Workshop</a></li>
              </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'OTRisk:walkdown' %}" tabindex="-1" ><i class="bi bi-kanban"></i> New Walkdown</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" tabindex="-1" ><i class="bi-file-earmark-easel"></i> Reports</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" tabindex="-1" ><i class="bi bi-ui-checks-grid"></i> Admin</a>
      </li>
          <li class="nav-item">
          <a href="#" onclick="window.open('{% static 'OTRisk/help_pha.html' %}', 'newwindow', 'width=600,height=400'); return false;"><i class="bi bi-question-circle"></i> Help</a>

      </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'accounts:profile' %}">
          <i class="bi bi-person-fill"></i> User: {{ user.first_name }} {{ user.last_name }}
        </a>

        </li>
      </ul>
    </div>
  </div>

</nav>

<div class="row">
    <div style="display: flex; justify-content: center; align-items: center;">
        <div style="text-align: center;">
            <br><br><br>
            <label class="form-label" style="font-size: larger; font-kerning: normal;">Site Walkdown Checklist</label>
        </div>
    </div>
    <div class="col-md-1"></div>
    <div class="col-md-4">
        <div class="table-container rounded-3">
            <table id="walkdown-table" class="table table-striped table-bordered small-font" >
                <thead>
                    <tr>
                        <!-- <th>ID</th> -->
                        <th>Name</th>
                        <th>Type</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for walkdown in walkdown_list %}
                        <tr class="walkdown-row" data-id="{{ walkdown.ID }}">
                            <!-- <td>{{ walkdown.ID }}</td> -->
                            <td class="word-wrap">{{ walkdown.OrganizationName }}</td>
                            <td>{{ walkdown.LocationType }}</td>
                            <td>{{ walkdown.WalkdownDate|slice:"5:7" }}/{{ walkdown.WalkdownDate|slice:"8:10" }}/{{ walkdown.WalkdownDate|slice:"2:4" }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

<div class="col-md-6">
    <form id="walkdown-form" action="{% url 'OTRisk:save_walkdown' %}" method="post">
    {% csrf_token %}

    <script>
      // Check if walkdown_session is a positive integer
      var walkdownSession = {{ walkdown_session }};
      if (Number.isInteger(walkdownSession) && walkdownSession > 0) {
        // Set the value of the local session variable "walkdownid"
        sessionStorage.setItem('walkdownid', walkdownSession);
      } else {
        // Set the value of the local session variable "walkdownid" to null
        sessionStorage.setItem('walkdownid', null);
      }
    </script>
    <div class="row">
        <div class="col-md-6">

            <div class="form-group">
              <label for="OrganizationName">Organization:</label>
              <select class="form-control" id="OrganizationName" name="OrganizationName">
                {% for facility_name in FacilityNames %}
                  <option value="{{ facility_name }}" {% if walkdown_facility == facility_name %}selected{% endif %}>{{ facility_name }}</option>
                {% endfor %}
              <option value="other">Other</option>
              </select>
            </div>
                <div class="form-group">
                  <label for="OtherOrganization">Other Organization:</label>
                  <input type="text" class="form-control" id="OtherFacilityType" name="OtherFacilityType" {% if walkdown_facilityType != 'Other' %}disabled{% endif %} value="{{ walkdown_facilityType }}">
                </div>
            <script>
              // Retrieve the FacilityName value from sessionStorage
              var facilityName = sessionStorage.getItem('FacilityName');
              document.getElementById('OrganizationName').value = facilityName;
             var organizationSelect = document.getElementById('OrganizationName');
              // Get the other organization input element
              var otherOrganizationInput = document.getElementById('OtherOrganization');

              // Set the value of the select element
              organizationSelect.value = facilityName;

              // Add event listener to toggle the other organization input field
              organizationSelect.addEventListener('change', function() {
                if (organizationSelect.value === 'other') {
                  otherOrganizationInput.disabled = false;
                } else {
                  otherOrganizationInput.disabled = true;
                }
              });
            </script>

<div class="form-group">
                <label for="LocationAddress">Address:</label>
                <textarea class="form-control" id="LocationAddress" name="LocationAddress" rows="4" style="resize: none"></textarea>
              </div>
              <div class="form-group">
                <label for="LocationType">Facility Type:</label>
                <select class="form-control" id="LocationType" name="LocationType" required>
                  <option value=""></option>
                  {% for facility_type in facility_types %}
                  <option value="{{ facility_type.FacilityType }}">{{ facility_type.FacilityType }}</option>
                  {% endfor %}
                    <option value="other">Other</option>
                </select>
              </div>
                <div class="form-group">
                  <label for="OtherFacilityType">Other Facility Type:</label>
                  <input type="text" class="form-control" id="OtherFacilityType" name="OtherFacilityType" disabled>
                </div>
                <script>
                  // Retrieve the FacilityName value from sessionStorage
                  var facilityType = sessionStorage.getItem('FacilityType');
                  document.getElementById('LocationType').value = facilityType;
                 // Get the select element
                  var locationTypeSelect = document.getElementById('LocationType');
                  // Get the other facility type input element
                  var otherFacilityTypeInput = document.getElementById('OtherFacilityType');

                  // Add event listener to toggle the other facility type input field
                  locationTypeSelect.addEventListener('change', function() {
                    if (locationTypeSelect.value === 'other') {
                      otherFacilityTypeInput.disabled = false;
                    } else {
                      otherFacilityTypeInput.disabled = true;
                    }
                  });

                </script>
              <div class="form-group">
                <label for="DisallowedZone">Zones not visited:</label>
                <textarea class="form-control" id="DisallowedZone" name="DisallowedZone" rows="4" style="resize: none"></textarea>
              </div>
                <button type="button" class="btn btn-danger" id="new-walkdown-btn" onclick="resetForm()">Clear Form</button>
            <script>// Event listener for the "New Walkdown" button

                function resetForm() {
                    // Ask for confirmation
                    var confirmReset = confirm('Are you sure you want to reset everything?');

                    if (confirmReset) {
                        // Reset the walkdownID session variable
                        sessionStorage.setItem('walkdownid', 0);

                        // Clear all question responses
                        var questionElements = document.querySelectorAll('input[type="radio"]');
                        questionElements.forEach(function(element) {
                            element.checked = false;
                        });

                        // Reset the OrganizationName select control
                        var organizationNameSelect = document.getElementById('OrganizationName');
                        organizationNameSelect.selectedIndex = 0;
                    }
                }
             </script>
              <button type="submit" class="btn btn-primary" id="save-walkdown-btn" onclick="confirmSave()">Create New</button>
                <script>
                    function confirmSave() {
                      if (confirm("Are you sure you want to save the record?")) {
                        // If user confirms, submit the form
                        document.getElementById('walkdown-form').submit();
                      }
                    }
                </script>

              <button type="button" class="btn btn-light"  onclick="generateExcelCategories()">Print Current</button>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="WalkdownLeader">Walkdown Leader:</label>
                <input type="text" class="form-control" id="WalkdownLeader" name="WalkdownLeader" required>
              </div>
              <div class="form-group">
                <label for="OrgContact">Organization Contact:</label>
                <input type="text" class="form-control" id="OrgContact" name="OrgContact" required>
              </div>
              <div class="form-group">
                <label for="WalkdownDate">Walkdown Date:</label>
                <input type="date" class="form-control" id="WalkdownDate" name="WalkdownDate" required>
              </div>
              <div class="form-group">
                <label for="WalkdownStartTime">Start Time:</label>
                <input type="time" class="form-control" id="WalkdownStartTime" name="WalkdownStartTime" required>
              </div>
              <div class="form-group">
                <label for="WalkdownEndTime">End Time:</label>
                <input type="time" class="form-control" id="WalkdownEndTime" name="WalkdownEndTime" required>
              </div>
              <div class="form-group">
                <label for="PeopleOnSite">Location Headcount:</label>
                <input type="number" class="form-control" id="PeopleOnSite" name="PeopleOnSite" required>
              </div>
              <div class="form-group">
                <label for="SafetyBriefingGiven">Safety Briefing:</label>
                <select class="form-control" id="SafetyBriefingGiven" name="SafetyBriefingGiven" required>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                </select>
              </div>


        </div>

    </div>
    </form>

    <div class="col-md-1"></div>
</div>

<form id="walkdown-form" method="POST">
  {% csrf_token %}
  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-6 small-font">
      <h2>Walkdown Questions</h2>
      <p>Answer Yes, No, or N/A ("Not Applicable") to each of the questions. If the response is "no," you may click the "risk assessment" button to set up a pending risk assessment record.</p>
      <div class="container" style="background-color: #eee;">
        <ul class="nav nav-tabs" id="categoryTabs">
          {% for category in question_categories %}
          <li class="nav-item">
            <a class="nav-link {% if forloop.first %}active{% endif %}" id="{{ category }}" data-bs-toggle="tab" href="#tab-{{ category }}">{{ category }}</a>
          </li>
          {% endfor %}
        </ul>
         <div class="row">
            <div class="progress mb-4">
              <label for="progress-bar" class="progress-label">Progress: </label>
              <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            <div class="progress-text">0 out of 0. 0 remaining</div>
            </div>
            <a href="#" id="goToUnansweredBtn" class="link-primary">Go to First Unanswered Question</a>
        </div>
        <div class="tab-content mt-4">
          {% for category in question_categories %}
          <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="tab-{{ category }}">
            {% for question in walkdown_questions|dictsort:'Category' %}
            {% if question.Category == category %}
            <div class="card mb-3">
              <div class="card-body" style="background-color: #97979A">
                <h6 class="card-title">{{ question.WalkdownQuestion }}</h6>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="response-{{ question.ID }}" id="response-yes-{{ question.ID }}" value="Yes">
                  <label class="form-check-label" for="response-yes-{{ question.ID }}">Yes</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="response-{{ question.ID }}" id="response-no-{{ question.ID }}" value="No">
                  <label class="form-check-label" for="response-no-{{ question.ID }}">No</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="response-{{ question.ID }}" id="response-na-{{ question.ID }}" value="N/A">
                  <label class="form-check-label" for="response-na-{{ question.ID }}">N/A</label>
                </div>
                <a href="#" class="btn btn-link">Do Risk Assessment</a>
              </div>
            </div>
            {% endif %}
            {% endfor %}
          </div>
          {% endfor %}
        </div>



        <div class="mt-4">
          <button type="button" class="btn btn-primary" id="save-walkdown-questionnaire-btn">Save</button>
            <button type="button" id="clearAnswersBtn" class="btn btn-danger">Clear Answers</button>

        </div>
      </div>
    </div>
  </div>
</form>

<script>
function updateProgress() {
  const totalQuestions = {{ walkdown_questions|length }};
  const answeredQuestions = document.querySelectorAll('input[name^="response-"]:checked').length;
  const remainingQuestions = totalQuestions - answeredQuestions;

  const progressPercentage = Math.floor((answeredQuestions / totalQuestions) * 100);
  const progressText = `${answeredQuestions} out of ${totalQuestions}. ${remainingQuestions} questions remaining`;

  const progressBar = document.querySelector('.progress-bar');
  progressBar.style.width = progressPercentage + '%';
  progressBar.setAttribute('aria-valuenow', progressPercentage);
  document.querySelector('.progress-text').textContent = progressText;
}

// Call the updateProgress() function initially to set the progress bar
updateProgress();





// Retrieve and update progress on page load
document.addEventListener('DOMContentLoaded', function() {
  const savedProgress = localStorage.getItem('questionnaireProgress');
  if (savedProgress) {
    const progressBar = document.querySelector('.progress-bar');
    progressBar.style.width = savedProgress + '%';
    progressBar.setAttribute('aria-valuenow', savedProgress);
    progressBar.textContent = savedProgress + '%';
  }
});

// Update progress on radio button change and save response
const radioButtons = document.querySelectorAll('input[name^="response-"]');
radioButtons.forEach(function(radioButton) {
  radioButton.addEventListener('change', function() {
    updateProgress();

    // Save the response in local storage
    const responseName = this.name;
    const responseValue = this.value;
    localStorage.setItem(responseName, responseValue);
  });

  // Retrieve and restore saved responses on page load
  const savedResponse = localStorage.getItem(radioButton.name);
  if (savedResponse) {
    radioButton.checked = (savedResponse === radioButton.value);
  }
});

document.addEventListener('DOMContentLoaded', function() {
  // Get the button element
  const goToUnansweredBtn = document.getElementById('goToUnansweredBtn');

  // Add event listener for the button click
  goToUnansweredBtn.addEventListener('click', function() {
    // Find the first unanswered question
    const unansweredQuestion = document.querySelector('input[name^="response-"]:not(:checked)');
    if (unansweredQuestion) {
      // Get the category tab that contains the unanswered question
      const categoryTab = unansweredQuestion.closest('.tab-pane');

      // Activate the category tab
      const categoryTabId = categoryTab.getAttribute('id');
      const categoryTabLink = document.querySelector(`a[href="#${categoryTabId}"]`);
      categoryTabLink.click();

      // Scroll to the unanswered question
      unansweredQuestion.scrollIntoView({ behavior: 'smooth' });
    }
  });
});

document.addEventListener('DOMContentLoaded', function() {
  const clearAnswersBtn = document.getElementById('clearAnswersBtn');

  clearAnswersBtn.addEventListener('click', function() {
    // Show confirmation dialog
    const confirmed = confirm('Are you sure you want to clear all your answers?');

    if (confirmed) {
      // Clear all the radio button responses
      const radioButtons = document.querySelectorAll('input[name^="response-"]');
      radioButtons.forEach(function(radioButton) {
        radioButton.checked = false;
      });

      // Clear the progress bar
      const progressBar = document.querySelector('.progress-bar');
      progressBar.style.width = '0%';
      progressBar.setAttribute('aria-valuenow', '0');
      progressBar.textContent = '0%';

      // Clear local storage
      localStorage.clear();
    }
  });
});
</script>

     <script>


document.addEventListener('DOMContentLoaded', function() {
    const saveBtn = document.getElementById('save-questionnaire-btn');
    const walkdownID = '{{ request.session.session_walkdown }}'; // Access the session variable

    saveBtn.addEventListener('click', function(event) {
        event.preventDefault();
        saveQuestionnaire(walkdownID);
    });
});
</script>

<script>
  const tabs = document.querySelectorAll('.tab');
  const categories = document.querySelectorAll('.category');



  function openCategory(evt, categoryName) {
    tabs.forEach((tab) => tab.classList.remove('active'));
    categories.forEach((category) => category.style.display = 'none');

    const currentTab = evt.currentTarget;
    const currentCategory = document.getElementById(categoryName);

    currentTab.classList.add('active');
    currentCategory.style.display = 'block';

  }

  tabs.forEach((tab) => {
    tab.addEventListener('click', (evt) => {
      const categoryName = evt.currentTarget.dataset.category;
      openCategory(evt, categoryName);
    });
  });

        // Function to set visual cue when mouseover a row
        $(document).on('mouseover', '.walkdown-row', function() {
            $(this).addClass('selected-row');
        });

        // Function to remove visual cue when mouseout of a row
        $(document).on('mouseout', '.walkdown-row', function() {
            $(this).removeClass('selected-row');
        });

        // Function to populate form fields when row is selected
        $(document).on('click', '.walkdown-row', function() {
            var rowId = $(this).data('id');
            $.ajax({
                url: '/OTRisk/get_walkdown_data/' + rowId,
                success: function(data) {
                    populateFormFields(data);
                }
            });
        });

        // Function to populate form fields with data
        function populateFormFields(data) {
            $('#WalkdownDate').val(data.WalkdownDate);
            $('#OrganizationName').val(data.OrganizationName);
            $('#LocationAddress').val(data.LocationAddress);
            $('#LocationCountry').val(data.LocationCountry);
            $('#LocationType').val(data.LocationType);
            $('#PeopleOnSite').val(data.PeopleOnSite);
            $('#WalkdownLeader').val(data.WalkdownLeader);
            $('#OrgContact').val(data.OrgContact);
            $('#WalkdownStartTime').val(data.WalkdownStartTime);
            $('#WalkdownEndTime').val(data.WalkdownEndTime);
            $('#DisallowedZones').val(data.DisallowedZones);
            $('#SafetyBriefingGiven').val(data.SafetyBriefingGiven);
        }


        // Function to save or update walkdown record on Save button click
        $(document).on('click', '#save-walkdown-btn', function() {
            var rowId = $('.selected-row').data('id') || 0;
            var form = $('#walkdown-form').serialize();
            $.ajax({
                url: '/OTRisk/save_walkdown/' + rowId + '/',
                type: 'POST',
                data: form,
                success: function(response) {
                    // Handle success response
                }
            });
        });

        // Function to handle Risk Assessment button click
        $(document).on('click', '.risk-assessment-btn', function() {
            var questionId = $(this).data('question-id');
            var walkdownId = $('.selected-row').data('id');
            var yesNoOption = $('.yes-no-option[data-question-id="' + questionId + '"]').val();
            var detailsInput = $('.details-input[data-question-id="' + questionId + '"]').val();
            var organizationName = $('#OrganizationName').val(); // Retrieve the value from the OrganizationName field

            var csrftoken = getCookie('csrftoken');

            $.ajax({
                url: '/OTRisk/create_walkdown_risk_assessment/',
                type: 'POST',
                data: {
                    'walkdownId': walkdownId,
                    'questionId': questionId,
                    'yesNoOption': yesNoOption,
                    'detailsInput': detailsInput,
                    'organizationName': organizationName
                },
                beforeSend: function(xhr, settings) {
                // Include CSRF token in the request headers
                xhr.setRequestHeader('X-CSRFToken', csrftoken);
                },
                success: function(response) {
                    // Handle success response
                }
            });
        });

        // Function to get the value of a specific cookie
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Function to switch tabs and show respective table
        $(document).on('click', '.tab', function() {
            var category = $(this).data('category');
            $('.tab').removeClass('active');
            $(this).addClass('active');
            $('.walkdown-questions').hide();
            $('.walkdown-questions[data-category="' + category + '"]').show();
        });

        $(document).ready(function() {
            $('[data-toggle="tooltip"]').tooltip();
            $('.tab').first().click(); // Activate the first tab by default
        });



    </script>
   <!-- Include Bootstrap JS and jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

</body>
</html>
