{% load static %}
<!DOCTYPE html>
<!--suppress ALL -->
<html lang="">
<head>

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">

<!-- Bootstrap Select CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.min.css">

<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css" rel="stylesheet">

<!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>

<!-- Bootstrap Select JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>


    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>

    <script>
        $('select').selectpicker();
    </script>


{% load django_bootstrap5 %}
 {% bootstrap_css %}
 {% bootstrap_javascript %}

 <title>Risk Assessment Worksheet</title>

  <style>
    .small-font {
        font-size: 0.8rem; /* adjust as needed */
   }

    .navbar-scroll .nav-link,
    .navbar-scroll .navbar-toggler-icon,
    .navbar-scroll .navbar-brand {
      color: #ffffff;
    }

    /* Color of the navbar BEFORE scroll */
    .navbar-scroll {
      background-color: #000000;
        text-decoration-color: #FFFFFF;
    }


    /* Color of the links AFTER scroll */
    .navbar-scrolled .nav-link,
    .navbar-scrolled .navbar-toggler-icon,
    .navbar-scroll .navbar-brand {
      color: #262626;
    }

    .navbar-logo {
    position: absolute;
    top: 5px; /* Adjust this as needed */
    left: 5; /* Adjust this as needed */
    height: 100px; /* Adjust this as needed */
    z-index: 10;
}

    #rawtable tbody tr:hover {
        background-color: #f5f5f5; /* Change this to the color you want */
    }

        .impactGauge {
            position: relative;
            width: 7vw;
            height: 7vw;
            box-sizing: border-box;
            float:left;
            margin:20px
        }
        .RRGauge {
            position: relative;
            width: 7vw;
            height: 7vw;
            box-sizing: border-box;
            float:left;
            margin:20px
        }


        .tab-content {
          border: 1px solid #dee2e6;
          border-top: transparent;
          padding: 15px;
        }

        .tab-content .tab-pane {
          background-color: #FFF;
          color: #0080FF;
          min-height: 300px;
          height: auto;
        }

.custom-bg {
    background-color: lightgrey;


}
.form-label {
    border: none;
    background-color: transparent;
    outline: none;
    cursor: default;
    font-weight: normal;
    color: black;
    padding: 0;
    margin: 0;
}

.nav-tabs .nav-link.active {
    font-weight: bold;
}

#rawtable tbody tr:hover {
            cursor: pointer;
        }
    </style>
</head>
    <!-- Initialize sliders when the page loads -->
   <script>

      window.onload = function() {
        initSlider("range_safety_1", "safetyrange_1");
        initSlider("range_life_1", "liferange_1");
        initSlider("range_production_1", "productionrange_1");
        initSlider("range_finance_1", "financerange_1");
        initSlider("range_reputation_1", "reputationrange_1");
        initSlider("range_environment_1", "environmentrange_1");
        initSlider("range_regulatory_1", "regulatoryrange_1");
        initSlider("range_supply_1", "supplyrange_1");
        initSlider("range_data_1", "datarange_1");
        initSlider("range_safety_2", "safetyrange_2");
        initSlider("range_life_2", "liferange_2");
        initSlider("range_production_2", "productionrange_2");
        initSlider("range_finance_2", "financerange_2");
        initSlider("range_reputation_2", "reputationrange_2");
        initSlider("range_environment_2", "environmentrange_2");
        initSlider("range_regulatory_2", "regulatoryrange_2");
        initSlider("range_supply_2", "supplyrange_2");
        initSlider("range_data_2", "datarange_2");
        initSlider("range_safety_3", "safetyrange_3");
        initSlider("range_life_3", "liferange_3");
        initSlider("range_production_3", "productionrange_3");
        initSlider("range_finance_3", "financerange_3");
        initSlider("range_reputation_3", "reputationrange_3");
        initSlider("range_environment_3", "environmentrange_3");
        initSlider("range_regulatory_3", "regulatoryrange_3");
        initSlider("range_supply_3", "supplyrange_3");
        initSlider("range_data_3", "datarange_3");
        initSlider("range_safety_4", "safetyrange_4");
        initSlider("range_life_4", "liferange_4");
        initSlider("range_production_4", "productionrange_4");
        initSlider("range_finance_4", "financerange_4");
        initSlider("range_reputation_4", "reputationrange_4");
        initSlider("range_environment_4", "environmentrange_4");
        initSlider("range_regulatory_4", "regulatoryrange_4");
        initSlider("range_supply_4", "supplyrange_4");
        initSlider("range_data_4", "datarange_4");
        initSlider("range_safety_5", "safetyrange_5");
        initSlider("range_life_5", "liferange_5");
        initSlider("range_production_5", "productionrange_5");
        initSlider("range_finance_5", "financerange_5");
        initSlider("range_reputation_5", "reputationrange_5");
        initSlider("range_environment_5", "environmentrange_5");
        initSlider("range_regulatory_5", "regulatoryrange_5");
        initSlider("range_supply_5", "supplyrange_5");
        initSlider("range_data_5", "datarange_5");
        initSlider("range_vuln_1", "vulnrange_1");
        initSlider("range_vuln_2", "vulnrange_2");
        initSlider("range_vuln_3", "vulnrange_3");
        initSlider("range_vuln_4", "vulnrange_4");
        initSlider("range_vuln_5", "vulnrange_5");
        initSlider("range_threat_1", "threatrange_1");
        initSlider("range_threat_2", "threatrange_2");
        initSlider("range_threat_3", "threatrange_3");
        initSlider("range_threat_4", "threatrange_4");
        initSlider("range_threat_5", "threatrange_5");
        initSlider("range_frequency_1", "frequencyrange_1");
        initSlider("range_frequency_2", "frequencyrange_2");
        initSlider("range_frequency_3", "frequencyrange_3");
        initSlider("range_frequency_4", "frequencyrange_4");
        initSlider("range_frequency_5", "frequencyrange_5");
        };
      </script>
<body>
<script>
    //disable all controls and reset local session variable when form loads
    document.addEventListener('DOMContentLoaded', function() {
        sessionStorage.setItem('editMode', '0');
        sessionStorage.setItem('scenario1id', '');
        sessionStorage.setItem('scenario2id', '');
        sessionStorage.setItem('scenario3id', '');
        sessionStorage.setItem('scenario4id', '');
        sessionStorage.setItem('scenario5id', '');
        sessionStorage.setItem('rawid', '');
        setRiskAssessmentRefreshNotRequired(1)
        setRiskAssessmentRefreshNotRequired(2)
        setRiskAssessmentRefreshNotRequired(3)
        setRiskAssessmentRefreshNotRequired(4)
        setRiskAssessmentRefreshNotRequired(5)
        document.getElementById("txtTitle").setAttribute('disabled', true);
        document.getElementById("txtLeader").setAttribute('disabled', true);
        document.getElementById("txtBU").setAttribute('disabled', true);
        document.getElementById("selectIndustry").setAttribute('disabled', true);
        document.getElementById("selectFacility").setAttribute('disabled', true);
        document.getElementById("selectTrigger").setAttribute('disabled', true);
        document.getElementById("selectStatus").setAttribute('disabled', true);
        document.getElementById("txtRevenue").setAttribute('disabled', true);
        document.getElementById("txtInsurance").setAttribute('disabled', true);
        document.getElementById("txtDeductable").setAttribute('disabled', true);
        document.getElementById("txtScenarioDescription_1").setAttribute('disabled', true);
        document.getElementById("txtScenarioDescription_2").setAttribute('disabled', true);
        document.getElementById("txtScenarioDescription_3").setAttribute('disabled', true);
        document.getElementById("txtScenarioDescription_4").setAttribute('disabled', true);
        document.getElementById("txtScenarioDescription_5").setAttribute('disabled', true);
        document.getElementById("selectThreat_1").setAttribute('disabled', true);
        document.getElementById("selectThreat_2").setAttribute('disabled', true);
        document.getElementById("selectThreat_3").setAttribute('disabled', true);
        document.getElementById("selectThreat_4").setAttribute('disabled', true);
        document.getElementById("selectThreat_5").setAttribute('disabled', true);
        document.getElementById("selectTactics_1").setAttribute('disabled', true);
        document.getElementById("selectTactics_2").setAttribute('disabled', true);
        document.getElementById("selectTactics_3").setAttribute('disabled', true);
        document.getElementById("selectTactics_4").setAttribute('disabled', true);
        document.getElementById("selectTactics_5").setAttribute('disabled', true);
        document.getElementById("txtAssets_1").setAttribute('disabled', true);
        document.getElementById("txtAssets_2").setAttribute('disabled', true);
        document.getElementById("txtAssets_3").setAttribute('disabled', true);
        document.getElementById("txtAssets_4").setAttribute('disabled', true);
        document.getElementById("txtAssets_5").setAttribute('disabled', true);
        document.getElementById("selectOutage_1").setAttribute('disabled', true);
        document.getElementById("selectOutage_2").setAttribute('disabled', true);
        document.getElementById("selectOutage_3").setAttribute('disabled', true);
        document.getElementById("selectOutage_4").setAttribute('disabled', true);
        document.getElementById("selectOutage_5").setAttribute('disabled', true);
        document.getElementById("outage_1").setAttribute('disabled', true);
        document.getElementById("outage_2").setAttribute('disabled', true);
        document.getElementById("outage_3").setAttribute('disabled', true);
        document.getElementById("outage_4").setAttribute('disabled', true);
        document.getElementById("outage_5").setAttribute('disabled', true);
         $('#saveBtn').prop('disabled', true);
         $('#actionBtn').prop('disabled', true);
         $('#editBtn').prop('disabled', true);
         $('#editBtn').prop('disabled', true);


    });

</script>

<nav class="navbar navbar-expand-lg navbar-scroll fixed-top shadow-0 border-bottom border-dark rounded">
  <div class="container-fluid d-flex justify-content-between">
   <a class="navbar-brand" href="{% url 'OTRisk:dashboardhome' %}"><img src="/static/images/logo1-2.jpg" style="height: 140px; width: 140px" class="navbar-logo" alt="">  </a>
      <h4 class="my-auto text-center flex-grow-1"><font color="white">QRAW - Quick Risk Assessment Worksheet</font></h4>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto">

        <li class="nav-item">
          <a class="nav-link" href="{% url 'OTRisk:qraw' %}"><i class="bi bi-journal-text"></i> Risk Assessment</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'OTRisk:iotaphamanager' %}"><i class="bi bi-journal-text"></i> CyberPHA</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" tabindex="-1" ><i class="bi-file-earmark-easel"></i> Reports</a>
        </li>
                <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-diagram-3"></i> Admin
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <li><a  class="dropdown-item" href="{% url 'OTRisk:add_scenario' %}">Scenario Manager</a></li>
                  <li><a  class="dropdown-item" href="{% url 'OTRisk:add_consequence' %}">Consequence Manager</a></li>
                  <li><a  class="dropdown-item" href="{% url 'OTRisk:admin_users' %}">Admin Users</a></li>

              </ul>

        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'accounts:profile' %}">
                <i class="bi bi-person-fill"></i> {{ user.first_name }} {{ user.last_name }} | {{ user.userprofile.organization.name }}
            </a>
        </li>

          <li class="nav-item">
            <a class="nav-link" href="{% url 'logout' %}">
                <i class="bi bi-box-arrow-right"></i> Logout
            </a>
        </li>
      </ul>
    </div>
  </div>

</nav>



<form name="frmRAW" id="frmRAW" method="POST" action="{% url 'OTRisk:qraw' %}">
{% csrf_token %}
<div class="row">
        <div class="col-md-1 "></div>
        <div class="col-md-10 ">
         <div class="row" style="background-color: darkgray; height: 10px"></div>
       </div>
        <div class="col-md-1 "></div>
    </div> <!-- dark grey stripe -->

<div class="row">
    <div class="col-md-1 bg-black"></div>

    <div class="col-md-10 custom-bg">
        <br><br><br>
        <label for="rawtable" class="form-label">Select a record in the table to view and edit the assessment</label>
        <table id="rawtable" class="table table-striped table-bordered small-font">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Status</th>
                <th>Date</th>
                <th>Trigger</th>
                <th>Facility Type</th>
                <th>Industry</th>
                <th>Business Unit</th>
                <th>Leader</th>
                <!-- Add more <th> elements for each field in the RAWorksheet model -->
            </tr>
        </thead>
        <tbody>
            {% for raws in raws %}
                <tr
                    data-revenue="{{ raws.revenue }}"
                    data-insurance="{{ raws.insurance }}"
                    data-deductable="{{ raws.deductable }}">
                    <td>{{ raws.ID }}</td>
                    <td>{{ raws.RATitle }}</td>
                    <td>{{ raws.StatusFlag }}</td>
                    <td>{{ raws.RADate }}</td>
                    <td>{{ raws.RATrigger }}</td>
                    <td>{{ raws.BusinessUnitType }}</td>
                    <td>{{ raws.industry }}</td>
                    <td>{{ raws.BusinessUnit }}</td>
                    <td>{{ raws.AssessorName }}</td>
                </tr>
            {% endfor %}
        </tbody>
        </table>

    </div> <!-- table view of existing risk assessments -->
    <div class="col-md-1 bg-black"></div>
</div>

<div class="row">
    <div class="col-md-1 bg-black"></div>
    <div class="col-md-10 ">
     <div class="row" style="background-color: darkgray; height: 10px"></div>
   </div>
    <div class="col-md-1 bg-black"></div>
</div> <!-- dark grey stripe -->
<div class="row">
    <div class="col-md-1 bg-black"></div>
    <div class="col-md-1" style="background-color: darkgray"></div>
    <div class="col-md-2" style="background-color: darkgray"><button class="form-control" id="addNewBtn" type="button"   data-bs-toggle="tooltip" data-bs-placement="top" title="Click this button to clear the form and enter and begin a new risk assessment">New Assessment</button></div>
    <div class="col-md-2" style="background-color: darkgray"><button class="form-control" id="editBtn" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Click this button to edit the current risk assessment and scenarios">Edit Assessment</button></div>
    <div class="col-md-2" style="background-color: darkgray"><button class="form-control" type="submit" id="saveBtn" data-bs-toggle="tooltip" data-bs-placement="top" title="Click this button to save the risk assessment and scenarios" onclick="return checkRiskAssessmentRefreshVariables();" >Save Assessment</button></div>
    <div class="col-md-2" style="background-color: darkgray">
    <button class="form-control" type="button" id="actionBtn" onclick="showRAActionsModal()">Add Remediation Action</button>
    </div>

        <!-- clear and reset scenario tabs -->
        <script>
            function showRAActionsModal() {
                var rawid = sessionStorage.getItem('rawid');  // Get the value from session storage

                if (rawid === null || rawid === "") {
                    alert("Please select a risk assessment from the table first before creating an action item.");
                } else {
                    $('#RAActionsModal').modal('show');  // Show the modal if rawid has a value
                }
            }


            document.addEventListener('DOMContentLoaded', function() {
              var enableButton = document.getElementById('addNewBtn');

              enableButton.addEventListener('click', function() {
                $('#saveBtn').prop('disabled', false);
                $('#actionBtn').prop('disabled', false);
                sessionStorage.setItem('editMode', '0');
                sessionStorage.setItem('addNew', '1');
                sessionStorage.setItem('rawid', '');
                document.getElementById("edit_mode").value="0";
                document.getElementById("txtTitle").disabled = false;
                document.getElementById("txtTitle").value = "";
                document.getElementById("txtRevenue").disabled = false;
                document.getElementById("txtRevenue").value = "";
                document.getElementById("txtInsurance").disabled = false;
                document.getElementById("txtInsurance").value = "";
                document.getElementById("txtDeductable").disabled = false;
                document.getElementById("txtDeductable").value = "";
                document.getElementById("txtLeader").disabled = false;
                document.getElementById("txtLeader").value = "";
                document.getElementById("txtBU").disabled = false;
                document.getElementById("txtBU").value = "";
                document.getElementById("selectIndustry").disabled = false;
                document.getElementById("selectIndustry").selectedIndex = 0;
                document.getElementById("selectFacility").disabled = false;
                document.getElementById("selectFacility").selectedIndex = 0;
                document.getElementById("selectTrigger").disabled = false;
                document.getElementById("selectTrigger").selectedIndex = 0;
                document.getElementById("selectStatus").disabled = false;
                document.getElementById("selectStatus").selectedIndex = 0;

                document.getElementById("scenario2-tab").click();
                document.getElementById("txtScenarioDescription_2").disabled = false;
                document.getElementById("txtScenarioDescription_2").value = "";
                document.getElementById("selectThreat_2").disabled = false;
                document.getElementById("selectThreat_2").value = "";
                document.getElementById("selectTactics_2").disabled = false;
                document.getElementById("selectTactics_2").value = "";
                 document.getElementById("txtAssets_2").disabled = false;
                 document.getElementById("txtAssets_2").value = "";
                 document.getElementById("selectOutage_2").value = '';
                document.getElementById("outage_2").value = 0;

                document.getElementById("scenario3-tab").click();
                document.getElementById("txtScenarioDescription_3").disabled = false;
                document.getElementById("txtScenarioDescription_3").value = "";
                document.getElementById("selectThreat_3").disabled = false;
                document.getElementById("selectThreat_3").value = "";
                document.getElementById("selectTactics_3").disabled = false;
                document.getElementById("selectTactics_3").value = "";
                document.getElementById("txtAssets_3").disabled = false;
                document.getElementById("txtAssets_3").value = "";
                document.getElementById("selectOutage_3").value = '';
                document.getElementById("outage_3").value = 0;

                document.getElementById("scenario4-tab").click();
                document.getElementById("selectThreat_4").disabled = false;
                document.getElementById("selectThreat_4").value = "";
                document.getElementById("selectTactics_4").disabled = false;
                document.getElementById("selectTactics_4").value = "";
                document.getElementById("txtAssets_4").disabled = false;
                document.getElementById("txtAssets_4").value = "";
                document.getElementById("txtScenarioDescription_4").disabled = false;
                document.getElementById("txtScenarioDescription_4").value = "";
                document.getElementById("selectOutage_4").value = '';
                document.getElementById("outage_4").value = 0;

                document.getElementById("scenario5-tab").click();
                document.getElementById("selectThreat_5").disabled = false;
                document.getElementById("selectThreat_5").value = "";
                document.getElementById("selectTactics_5").disabled = false;
                document.getElementById("selectTactics_5").value = "";
                document.getElementById("txtAssets_5").disabled = false;
                document.getElementById("txtAssets_5").value = "";
                document.getElementById("txtScenarioDescription_5").disabled = false;
                document.getElementById("txtScenarioDescription_5").value = "";

                document.getElementById("scenario1-tab").click();
                document.getElementById("selectThreat_1").value = "";
                document.getElementById("selectTactics_1").disabled = false;
                document.getElementById("selectTactics_1").value = "";
                document.getElementById("txtAssets_1").disabled = false;
                document.getElementById("txtAssets_1").value = "";
                document.getElementById("txtScenarioDescription_1").disabled = false;
                document.getElementById("txtScenarioDescription_1").value = "";
                document.getElementById("selectThreat_1").disabled = false;
                document.getElementById("selectOutage_1").value = '';
                document.getElementById("outage_1").value = 0;
                document.getElementById("editBtn").disabled = true;

               });
            });

            document.addEventListener('DOMContentLoaded', function() {
              var enableButton = document.getElementById('editBtn');

              enableButton.addEventListener('click', function() {
                $('#saveBtn').prop('disabled', false);
                $('#actionBtn').prop('disabled', false);
                sessionStorage.setItem('editMode', '1');
                sessionStorage.setItem('addNew', '0');
                document.getElementById("edit_mode").value="1";
                document.getElementById("txtTitle").disabled = false;
                document.getElementById("txtRevenue").disabled = false;
                document.getElementById("txtInsurance").disabled = false;
                document.getElementById("txtDeductable").disabled = false;
                document.getElementById("txtLeader").disabled = false;
                document.getElementById("txtBU").disabled = false;
                document.getElementById("selectIndustry").disabled = false;
                document.getElementById("selectFacility").disabled = false;
                document.getElementById("selectTrigger").disabled = false;
                document.getElementById("selectStatus").disabled = false;

                document.getElementById("scenario2-tab").click();
                document.getElementById("txtScenarioDescription_2").disabled = false;
                document.getElementById("selectThreat_2").disabled = false;
                document.getElementById("selectTactics_2").disabled = false;
                 document.getElementById("txtAssets_2").disabled = false;
                 document.getElementById("selectOutage_2").disabled = false;
                 document.getElementById("outage_2").disabled = false;

                document.getElementById("scenario3-tab").click();
                document.getElementById("txtScenarioDescription_3").disabled = false;
                document.getElementById("selectThreat_3").disabled = false;
                document.getElementById("selectTactics_3").disabled = false;
                document.getElementById("txtAssets_3").disabled = false;
                 document.getElementById("selectOutage_3").disabled = false;
                 document.getElementById("outage_3").disabled = false;

                document.getElementById("scenario4-tab").click();
                document.getElementById("selectThreat_4").disabled = false;
                document.getElementById("selectTactics_4").disabled = false;
                document.getElementById("txtAssets_4").disabled = false;
                document.getElementById("txtScenarioDescription_4").disabled = false;
                 document.getElementById("selectOutage_4").disabled = false;
                 document.getElementById("outage_4").disabled = false;

                document.getElementById("scenario5-tab").click();
                document.getElementById("selectThreat_5").disabled = false;
                document.getElementById("selectTactics_5").disabled = false;
                document.getElementById("txtAssets_5").disabled = false;
                document.getElementById("txtScenarioDescription_5").disabled = false;
                 document.getElementById("selectOutage_5").disabled = false;
                 document.getElementById("outage_5").disabled = false;

                document.getElementById("scenario1-tab").click();
                document.getElementById("selectTactics_1").disabled = false;
                document.getElementById("txtAssets_1").disabled = false;
                document.getElementById("txtScenarioDescription_1").disabled = false;
                document.getElementById("selectThreat_1").disabled = false;
                 document.getElementById("selectOutage_1").disabled = false;
                 document.getElementById("outage_1").disabled = false;
               });
            });

        </script>
    <div class="col-md-1" style="background-color: darkgray"></div>
    <div class="col-md-1 bg-black"></div>

</div>
<div class="row">
    <div class="col-md-1 bg-black"></div>
    <div class="col-md-10 ">
     <div class="row" style="background-color: darkgray; height: 10px"></div>
   </div>
    <div class="col-md-1 bg-black"></div>
</div> <!-- dark grey stripe -->
<input type="hidden" name="edit_mode" id="edit_mode">
<input type="hidden" name="scenarioCount" id="scenarioCount">
<input type="hidden" name="hdnRawID" id="hdnRawID">

<div class="row">
    <div class="col-md-1 bg-black"></div>

    <div class="col-md-10 border border-dark shadow small-font">
        <div class="row">
            <div class="col-md-4">
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="txtTitle" >Organization Name</label>
                        <input type="text" class="form-control" name="txtTitle" id="txtTitle" required/>
                    </div>
                </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="txtBU">Business Unit</label>
                        <input type="text" class="form-control" name="txtBU" id="txtBU" required>
                    </div>
                </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="txtLeader">Assessment Leader</label>
                        <input type="text" class="form-control" name="txtLeader" id="txtLeader" required>
                    </div>
                </div>
                <br>
            </div>

            <div class="col-md-4">
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="selectIndustry">Industry</label>
                        <select id="selectIndustry" name="selectIndustry" class="form-control">
                            <option value="">-- Select Industry --</option>
                            {% for industry in industries %}
                                <option value="{{ industry.Industry }}">{{ industry.Industry }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="selectFacility">Facility Type</label>
                    <select id="selectFacility" name="selectFacility" class="form-control">
                        <option value="">-- Select Facility --</option>
                        {% for facility in facilities %}
                            <option value="{{ facility.FacilityType}}">{{ facility.FacilityType }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="selectTrigger" >Trigger Event</label>
                    <select id="selectTrigger" name="selectTrigger" class="form-control">
                        <option value="">-- Select Assessment Trigger --</option>
                        <option value="Audit - External">Audit - External</option>
                        <option value="Audit - Internal">Audit - Internal</option>
                        <option value="Change Request">Change Request</option>
                        <option value="Incident">Incident</option>
                        <option value="Scheduled Assessment">Scheduled Assessment</option>
                        <option value="Site Walkdown">Site Walkdown</option>
                    </select>
                </div>
            </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="selectStatus" >Status</label>
                    <select id="selectStatus" name="selectStatus" class="form-control">
                        <option value="">-- Select Status --</option>
                        <option value="Open">Open</option>
                        <option value="Closed">Closed</option>
                    </select>
                </div>
            </div>
            </div>
            <div class="col-md-4">
             <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="txtRevenue">Annual Revenue</label>
                        <input type="text" class="form-control" name="txtRevenue" id="txtRevenue" >
                    </div>
                 <script>
                 $(document).ready(function() {
                    $("#txtRevenue").on("input", function() {
                        // Remove any non-digit characters
                        var val = $(this).val().replace(/[^0-9]/g, '');

                        // Convert to whole number currency format
                        var currencyVal = parseInt(val, 10).toLocaleString('en-US');

                        // Set the formatted value
                        $(this).val(currencyVal);
                    });
                });
                 </script>

             </div>
             <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="txtInsurance">Cyber Insurance Cover</label>
                        <input type="text" class="form-control" name="txtInsurance" id="txtInsurance" >
                        <script>
                 $(document).ready(function() {
                    $("#txtInsurance").on("input", function() {
                        // Remove any non-digit characters
                        var val = $(this).val().replace(/[^0-9]/g, '');

                        // Convert to whole number currency format
                        var currencyVal = parseInt(val, 10).toLocaleString('en-US');

                        // Set the formatted value
                        $(this).val(currencyVal);
                    });
                });
                 </script>
                        <br>
                        <label for="txtDeductable">Insurance Deductable Amount</label>
                        <script>
                 $(document).ready(function() {
                    $("#txtDeductable").on("input", function() {
                        // Remove any non-digit characters
                        var val = $(this).val().replace(/[^0-9]/g, '');

                        // Convert to whole number currency format
                        var currencyVal = parseInt(val, 10).toLocaleString('en-US');

                        // Set the formatted value
                        $(this).val(currencyVal);
                    });
                });
                 </script>
                        <input type="text" class="form-control" name="txtDeductable" id="txtDeductable" >
                    </div>
             </div>
             <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <a id="generateReportLink" href="#">Generate Report</a>
                    </div>
                </div>

                <br>
            </div>

    </div>
    <div class="col-md-1"></div>
</div>

    <div class="col-md-1 bg-black"></div>
</div>

<div class="row">
    <div class="col-md-1 bg-black"></div>
    <div class="col-md-10 ">
     <div class="row" style="background-color: darkgray; height: 10px"></div>
   </div>
    <div class="col-md-1 bg-black"></div>
</div> <!-- dark grey stripe -->

<div class="row">
    <div class="col-md-1 bg-black"></div>

    <div class="col-md-10">
    <div class="container-fluid small-font">
      <ul class="nav nav-tabs">
        <li class="nav-item">
            <a class="nav-link active" id="scenario1-tab" data-bs-toggle="tab" href="#scenario1" style="background-color: #FFD1DC;">Scenario 1</a>
        </li>
        <li class="nav-item">
            <a class="nav-link " id="scenario2-tab" data-bs-toggle="tab" href="#scenario2" style="background-color: #D1FFD6;">Scenario 2</a>
        </li>
        <li class="nav-item">
            <a class="nav-link " id="scenario3-tab" data-bs-toggle="tab" href="#scenario3" style="background-color: #FFF5BA;">Scenario 3</a>
        </li>
        <li class="nav-item">
            <a class="nav-link " id="scenario4-tab" data-bs-toggle="tab" href="#scenario4" style="background-color: #D6E5FA;">Scenario 4</a>
        </li>
        <li class="nav-item">
            <a class="nav-link " id="scenario5-tab" data-bs-toggle="tab" href="#scenario5" style="background-color: #FFD1B2;">Scenario 5</a>
        </li>
    </ul>


      <div class="tab-content">
        <div class="tab-pane active" id="scenario1">
            <div class="row">
            <div class="col-md-4 small-font">
               <!-- tab 1 left column -->
                <input type="hidden" name="hdnScenarioID_1" id="hdnScenarioID_1">
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="txtScenarioDescription_1" class="form-control border-0 align-text-bottom small-font" data-bs-toggle="modal" data-bs-target="#scenarioModal">Scenario Description (click for table)</label>
                    <textarea class="form-control small-font" name="txtScenarioDescription_1" id="txtScenarioDescription_1" rows="3" style="resize: none; word-wrap: normal" onchange="setRiskAssessmentRefreshRequired(1)"></textarea>
                </div>
              </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <label for="selectOutage_1" class="form-control border-0 small-font">Production Outage</label>
                              <select id="selectOutage_1" name="selectOutage_1" class="form-control small-font">
                                <option value="N/A">-- Select Outage --</option>
                                <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                              </select>
                        </div>
                        <div class="col-md-6">
                            <label for="outage_1" class="form-control border-0 small-font">Outage Length (in hours):</label>
                            <input type="number" id="outage_1" name="outage_1" min="0" max="100" class="form-control">
                        </div>
                    </div>
                </div>
              </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                  <label for="selectThreat_1" class="form-control border-0 small-font">Threat Source</label>
                  <select id="selectThreat_1" name="selectThreat_1" class="form-control small-font">
                    <option value="">-- Select Threat Source --</option>
                    {% for threatsources in threatsources %}
                        <option value="{{ threatsources.ThreatSource}}">{{ threatsources.ThreatSource }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                  <label for="selectTactics_1" class="form-control border-0 small-font">Threat Tactics (Mitre)</label>
                  <select id="selectTactics_1" name="selectTactics_1" class="form-control small-font">
                    <option value="">-- Select Threat Tactics --</option>
                    {% for mitreTactics in mitreTactics %}
                        <option value="{{ mitreTactics.tactic}}">{{ mitreTactics.tactic }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="txtAssets_1" class="form-control border-0 align-text-bottom small-font">Asset Name/s:</label>
                    <textarea class="form-control small-font" name="txtAssets_1" id="txtAssets_1" rows="3" style="resize: none; word-wrap: normal" placeholder="Add asset names relevant to the scenario..."></textarea>
                </div>
              </div>
                </div>
            <div class="col-md-4 small-font">
                <h5>Business Impact Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#safetyModal_1" data-bs-placement="top" style="cursor: pointer">Safety</label></div>
                                <div class="col-7">
                                    <label for="range_safety_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_safety_1" name="range_safety_1" onchange="initSlider('range_safety_1', 'safetyrange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><label id="safetyrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                              </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for life rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#lifeModal_1" data-bs-placement="top" style="cursor: pointer">Life</label></div>
                                <div class="col-7">
                                    <label for="range_life_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_life_1" name="range_life_1" onchange="initSlider('range_life_1', 'liferange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="liferange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#productionModal_1" data-bs-placement="top" style="cursor: pointer">Production</label></div>
                                <div class="col-7">
                                    <label for="range_production_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_production_1" name="range_production_1" onchange="initSlider('range_production_1', 'productionrange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="productionrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                             <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#financeModal_1"  data-bs-placement="top" style="cursor: pointer">Financial</label></div>
                                <div class="col-7">
                                    <label for="range_finance_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_finance_1" name="range_finance_1" onchange="initSlider('range_finance_1', 'financerange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="financerange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#reputationModal_1"  data-bs-placement="top" style="cursor: pointer">Reputation</label></div>
                                <div class="col-7">
                                    <label for="range_reputation_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_reputation_1" name="range_reputation_1" onchange="initSlider('range_reputation_1', 'reputationrange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="reputationrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for environment impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#environmentModal_1"  data-bs-placement="top" style="cursor: pointer">Environment</label></div>
                                <div class="col-7">
                                    <label for="range_environment_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_environment_1" name="range_environment_1" onchange="initSlider('range_environment_1', 'environmentrange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="environmentrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for regulatory impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#regulationModal_1"  data-bs-placement="top" style="cursor: pointer">Regulatory</label></div>
                                <div class="col-7">
                                    <label for="range_regulatory_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_regulatory_1" name="range_regulatory_1" onchange="initSlider('range_regulatory_1', 'regulatoryrange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="regulatoryrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#dataModal_1"  data-bs-placement="top" style="cursor: pointer">Data/IP</label></div>
                                <div class="col-7">
                                    <label for="range_data_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_data_1" name="range_data_1" onchange="initSlider('range_data_1', 'datarange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="datarange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#supplyModal_1"  data-bs-placement="top" style="cursor: pointer">Supply Chain</label></div>
                                <div class="col-7">
                                    <label for="range_supply_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_supply_1" name="range_supply_1" onchange="initSlider('range_supply_1', 'supplyrange_1');setRiskAssessmentRefreshRequired(1);">
                                </div>
                                <div class="col-3"><h6><label id="supplyrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <h5>Vulnerability and Likelihood Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for vulnerability rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#vulnModal_1"  data-bs-placement="top" style="cursor: pointer">Vulnerability</label></div>
                                <div class="col-7">
                                    <label for="range_vuln_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_vuln_1" name="range_vuln_1" onchange="initSlider('range_vuln_1', 'vulnrange_1')">
                                </div>
                                <div class="col-3"><label id="vulnrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to estimate the danger to life of the selected scenario">Threat</label></div>
                                <div class="col-7">
                                    <label for="range_threat_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_threat_1" name="range_threat_1" onchange="initSlider('range_threat_1', 'threatrange_1');">
                                </div>
                                <div class="col-3"><h6><label id="threatrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for frequency-->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to indicate asset status">Asset Status</label></div>
                                <div class="col-7">
                                    <label for="range_frequency_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_frequency_1" name="range_frequency_1" onchange="initFrequencySlider('range_frequency_1', 'frequencyrange_1');">
                                </div>
                                <div class="col-3"><h6><label id="frequencyrange_1" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

            </div>
            <div class="col-md-4 small-font">
                <!-- Risk Assessment Button -->
                <button id="risk-assessment-btn_1" type="button" class="btn btn-primary" onclick="executeRiskAssessment(this.id, 'loadingSpinner1');">
                    <i class="bi bi-play-fill mr-2"></i>Execute Risk Assessment
                </button>

                <!-- Add this HTML element where you want to display the loading spinner -->
                <div id="loadingSpinner1" class="spinner-border" role="status" style="display: none;">
                  <span class="visually-hidden">Loading...</span>
                </div>

                     <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label class="form-label">Risk Score: </label>
                            <input type="text" id="lblriskScore_1" name="lblriskScore_1" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Rating: </label>
                            <input type="text" id="lblriskRating_1" name="lblriskRating_1" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Estimated Event Costs (Low): </label>
                            <input type="text" id="lblriskCost_1" name="lblriskCost_1" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (High): </label>
                            <input type="text" id="lblriskCostHigh_1" name="lblriskCostHigh_1" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (Median): </label>
                            <input type="text" id="lblriskCostMedian_1" name="lblriskCostMedian_1" class="form-control" readonly><br>
                        </div>
                    </div>


                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Summary: </label>
                            <textarea id="lblriskSummary_1" name="lblriskSummary_1" class="form-control" readonly style="resize: none" rows="3"></textarea>
                        </div>
                    </div>


                </div>
            </div>
        </div>
        <div class="tab-pane" id="scenario2">
          <!-- Scenario 2 controls -->
            <div class="row">
                <div class="col-md-4 small-font">
                <!-- tab 1 left column -->
                    <input type="hidden" name="hdnScenarioID_2" id="hdnScenarioID_2">
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label for="txtScenarioDescription_2" class="form-control border-0 align-text-bottom small-font" data-bs-toggle="modal" data-bs-target="#scenarioModal">Scenario Description (click for table)</label>
                            <textarea class="form-control small-font" name="txtScenarioDescription_2" id="txtScenarioDescription_2" rows="3" style="resize: none; word-wrap: normal" onchange="setRiskAssessmentRefreshRequired(2)"></textarea>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="selectOutage_2" class="form-control border-0 small-font">Production Outage</label>
                                      <select id="selectOutage_2" name="selectOutage_2" class="form-control small-font">
                                        <option value="N/A">-- Select Outage --</option>
                                        <option value="Yes">Yes</option>
                                          <option value="No">No</option>
                                      </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="outage_2" class="form-control border-0 small-font">Outage Length (in hours):</label>
                                    <input type="number" id="outage_2" name="outage_2" min="0" max="100" class="form-control">
                                </div>
                            </div>
                        </div>
                  </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label for="selectThreat_2" class="form-control border-0">Threat Source</label>
                            <select id="selectThreat_2" name="selectThreat_2" class="form-control small-font">
                                <option value="">-- Select Threat Source --</option>
                                    {% for threatsources in threatsources %}
                                        <option value="{{ threatsources.ThreatSource}}">{{ threatsources.ThreatSource }}</option>
                                    {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label for="selectTactics_2" class="form-control border-0">Threat Tactics (Mitre)</label>
                            <select id="selectTactics_2" name="selectTactics_2" class="form-control">
                                <option value="">-- Select Threat Tactics --</option>
                                    {% for mitreTactics in mitreTactics %}
                                        <option value="{{ mitreTactics.tactic}}">{{ mitreTactics.tactic }}</option>
                                    {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                           <label for="txtAssets_1" class="form-control border-0 align-text-bottom small-font">Asset Name/s</label>
                           <textarea class="form-control small-font" name="txtAssets_2" id="txtAssets_2" rows="3" style="resize: none; word-wrap: normal" placeholder="Add asset names relevant to the scenario..."></textarea>
                        </div>
                    </div>
          </div>
            <div class="col-md-4 small-font">

                <h5>Business Impact Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#safetyModal_2" data-bs-placement="top" style="cursor: pointer">Safety</label></div>
                                <div class="col-7">
                                    <label for="range_safety_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_safety_2" name="range_safety_2" onchange="initSlider('range_safety_2', 'safetyrange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><label id="safetyrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for life rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#lifeModal_2" data-bs-placement="top" style="cursor: pointer">Life</label></div>
                                <div class="col-7">
                                    <label for="range_life_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_life_2" name="range_life_2" onchange="initSlider('range_life_2', 'liferange_2'); setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="liferange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#productionModal_2" data-bs-placement="top" style="cursor: pointer">Production</label></div>
                                <div class="col-7">
                                    <label for="range_production_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_production_2" name="range_production_2" onchange="initSlider('range_production_2', 'productionrange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="productionrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                             <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#financeModal_2" data-bs-placement="top" style="cursor: pointer">Financial</label></div>
                                <div class="col-7">
                                    <label for="range_finance_2"></label>
                                    <input type="range" min="1" max="10" value="1" class="form-range" id="range_finance_2" name="range_finance_2" onchange="initSlider('range_finance_2', 'financerange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="financerange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#reputationModal_2" data-bs-placement="top" style="cursor: pointer">Reputation</label></div>
                                <div class="col-7">
                                    <label for="range_reputation_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_reputation_2" name="range_reputation_2" onchange="initSlider('range_reputation_2', 'reputationrange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="reputationrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for environment impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#environmentModal_2" data-bs-placement="top" style="cursor: pointer">Environment</label></div>
                                <div class="col-7">
                                    <label for="range_environment_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_environment_2" name="range_environment_2" onchange="initSlider('range_environment_2', 'environmentrange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="environmentrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for regulatory impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#regulationModal_2" data-bs-placement="top" style="cursor: pointer">Regulatory</label></div>
                                <div class="col-7">
                                    <label for="range_regulatory_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_regulatory_2" name="range_regulatory_2" onchange="initSlider('range_regulatory_2', 'regulatoryrange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="regulatoryrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#dataModal_2" data-bs-placement="top" style="cursor: pointer">Data/IP</label></div>
                                <div class="col-7">
                                    <label for="range_data_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_data_2" name="range_data_2" onchange="initSlider('range_data_2', 'datarange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="datarange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#supplyModal_2" data-bs-placement="top" style="cursor: pointer">Supply Chain</label></div>
                                <div class="col-7">
                                    <label for="range_supply_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_supply_2" name="range_supply_2" onchange="initSlider('range_supply_2', 'supplyrange_2');setRiskAssessmentRefreshRequired(2);">
                                </div>
                                <div class="col-3"><h6><label id="supplyrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <h5>Vulnerability and Likelihood Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                           <!--slider for vulnerability rating -->
                           <div class="slider-container d-flex align-items-center" >
                               <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#vulnModal_2"  data-bs-placement="top" style="cursor: pointer">Vulnerability</label></div>
                               <div class="col-7">
                                   <label for="range_vuln_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_vuln_2" name="range_vuln_2" onchange="initSlider('range_vuln_2', 'vulnrange_2')">
                               </div>
                               <div class="col-3"><label id="vulnrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                           </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                           <!--slider for safety rating -->
                           <div class="slider-container d-flex align-items-center">
                               <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to estimate the danger to life of the selected scenario">Threat</label></div>
                               <div class="col-7">
                                   <label for="range_threat_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_threat_2" name="range_threat_2" onchange="initSlider('range_threat_2', 'threatrange_2');">
                               </div>
                               <div class="col-3"><h6><label id="threatrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                           </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                           <!--slider for frequency-->
                           <div class="slider-container d-flex align-items-center">
                               <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to indicate asset status">Asset Status</label></div>
                               <div class="col-7">
                                   <label for="range_frequency_2"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_frequency_2" name="range_frequency_2" onchange="initFrequencySlider('range_frequency_2', 'frequencyrange_2');">
                               </div>
                               <div class="col-3"><h6><label id="frequencyrange_2" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                           </div>
                        </div>
                    </div>

           </div>

            <div class="col-md-4 small-font">
                <!-- Risk Assessment Button -->
                <button id="risk-assessment-btn_2" type="button" class="btn btn-primary" onclick="executeRiskAssessment(this.id, 'loadingSpinner2')">
                    <i class="bi bi-play-fill mr-2"></i>Execute Risk Assessment
                </button>

                <!-- Add this HTML element where you want to display the loading spinner -->
                <div id="loadingSpinner2" class="spinner-border" role="status" style="display: none;">
                  <span class="visually-hidden">Loading...</span>
                </div>

                     <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label class="form-label">Risk Score: </label>
                            <input type="text" id="lblriskScore_2" name="lblriskScore_2" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Rating: </label>
                            <input type="text" id="lblriskRating_2" name="lblriskRating_2" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Estimated Event Costs (Low): </label>
                            <input type="text" id="lblriskCost_2" name="lblriskCost_2" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (High): </label>
                            <input type="text" id="lblriskCostHigh_2" name="lblriskCostHigh_2" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (Median): </label>
                            <input type="text" id="lblriskCostMedian_2" name="lblriskCostMedian_2" class="form-control" readonly><br>
                        </div>
                    </div>


                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Summary: </label>
                            <textarea id="lblriskSummary_2" name="lblriskSummary_2" class="form-control" readonly style="resize: none" rows="3"></textarea>
                        </div>
                    </div>


                </div>
            </div>
        </div>
        <div class="tab-pane " id="scenario3">
          <!-- Scenario 3 controls -->
            <div class="row">
          <div class="col-md-4 small-font">
                <input type="hidden" name="hdnScenarioID_3" id="hdnScenarioID_3">
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                          <label for="txtScenarioDescription_3" class="form-control border-0 align-text-bottom small-font" data-bs-toggle="modal" data-bs-target="#scenarioModal">Scenario Description (click for table)</label>
                          <textarea class="form-control small-font" name="txtScenarioDescription_3" id="txtScenarioDescription_3" rows="3" style="resize: none; word-wrap: normal" onchange="setRiskAssessmentRefreshRequired(3)"></textarea>
                    </div>
                </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="selectOutage_3" class="form-control border-0 small-font">Production Outage</label>
                                  <select id="selectOutage_3" name="selectOutage_3" class="form-control small-font">
                                    <option value="N/A">-- Select Outage --</option>
                                    <option value="Yes">Yes</option>
                                      <option value="No">No</option>
                                  </select>
                            </div>
                            <div class="col-md-6">
                                <label for="outage_3" class="form-control border-0 small-font">Outage Length (in hours):</label>
                                <input type="number" id="outage_3" name="outage_3" min="0" max="100" class="form-control">
                            </div>
                        </div>
                    </div>
                  </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                          <label for="selectThreat_3" class="form-control border-0 small-font">Threat Source</label>
                          <select id="selectThreat_3" name="selectThreat_3" class="form-control">
                            <option value="">-- Select Threat Source --</option>
                            {% for threatsources in threatsources %}
                                <option value="{{ threatsources.ThreatSource}}">{{ threatsources.ThreatSource }}</option>
                            {% endfor %}
                          </select>
                    </div>
                </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                      <label for="selectTactics_3" class="form-control border-0 small-font">Threat Tactics (Mitre)</label>
                      <select id="selectTactics_3" name="selectTactics_3" class="form-control">
                        <option value="">-- Select Threat Tactics --</option>
                        {% for mitreTactics in mitreTactics %}
                            <option value="{{ mitreTactics.tactic}}">{{ mitreTactics.tactic }}</option>
                        {% endfor %}
                      </select>
                    </div>
                </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <label for="txtAssets_3" class="form-control border-0 align-text-bottom">Asset Name/s</label>
                        <textarea class="form-control" name="txtAssets_3" id="txtAssets_3" rows="3" style="resize: none; word-wrap: normal" placeholder="Add asset names relevant to the scenario..."></textarea>
                    </div>
                </div>
            </div>
            <div class="col-md-4 small-font">

                <h5>Business Impact Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#safetyModal_3" data-bs-placement="top" style="cursor: pointer">Safety</label></div>
                                <div class="col-7">
                                    <label for="range_safety_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_safety_3" name="range_safety_3" onchange="initSlider('range_safety_3', 'safetyrange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><label id="safetyrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for life rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#lifeModal_3" data-bs-placement="top" style="cursor: pointer">Life</label></div>
                                <div class="col-7">
                                    <label for="range_life_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_life_3" name="range_life_3" onchange="initSlider('range_life_3', 'liferange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="liferange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#productionModal_3" data-bs-placement="top" style="cursor: pointer">Production</label></div>
                                <div class="col-7">
                                    <label for="range_production_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_production_3" name="range_production_3" onchange="initSlider('range_production_3', 'productionrange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="productionrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                             <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#financeModal_3" data-bs-placement="top" style="cursor: pointer">Financial</label></div>
                                <div class="col-7">
                                    <label for="range_finance_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_finance_3" name="range_finance_3" onchange="initSlider('range_finance_3', 'financerange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="financerange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#reputationModal_3" data-bs-placement="top" style="cursor: pointer">Reputation</label></div>
                                <div class="col-7">
                                    <label for="range_reputation_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_reputation_3" name="range_reputation_3" onchange="initSlider('range_reputation_3', 'reputationrange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="reputationrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for environment impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#environmentModal_3" data-bs-placement="top" style="cursor: pointer">Environment</label></div>
                                <div class="col-7">
                                    <label for="range_environment_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_environment_3" name="range_environment_3" onchange="initSlider('range_environment_3', 'environmentrange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="environmentrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for regulatory impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#regulationModal_3" data-bs-placement="top" style="cursor: pointer">Regulatory</label></div>
                                <div class="col-7">
                                    <label for="range_regulatory_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_regulatory_3" name="range_regulatory_3" onchange="initSlider('range_regulatory_3', 'regulatoryrange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="regulatoryrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#dataModal_3" data-bs-placement="top" style="cursor: pointer">Data/IP</label></div>
                                <div class="col-7">
                                    <label for="range_data_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_data_3" name="range_data_3" onchange="initSlider('range_data_3', 'datarange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="datarange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#supplyModal_3" data-bs-placement="top" style="cursor: pointer">Supply Chain</label></div>
                                <div class="col-7">
                                    <label for="range_supply_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_supply_3" name="range_supply_3" onchange="initSlider('range_supply_3', 'supplyrange_3');setRiskAssessmentRefreshRequired(3);">
                                </div>
                                <div class="col-3"><h6><label id="supplyrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <br>
                <h5>Vulnerability and Likelihood Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for vulnerability rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#vulnModal_3" data-bs-placement="top" style="cursor: pointer">Vulnerability</label></div>
                                <div class="col-7">
                                    <label for="range_vuln_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_vuln_3" name="range_vuln_3" onchange="initSlider('range_vuln_3', 'vulnrange_3')">
                                </div>
                                <div class="col-3"><label id="vulnrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="">Threat</label></div>
                                <div class="col-7">
                                    <label for="range_threat_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_threat_3" name="range_threat_3" onchange="initSlider('range_threat_3', 'threatrange_3');">
                                </div>
                                <div class="col-3"><h6><label id="threatrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for Asset Status-->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to indicate asset status">Asset Status</label></div>
                                <div class="col-7">
                                    <label for="range_frequency_3"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_frequency_3" name="range_frequency_3" onchange="initFrequencySlider('range_frequency_3', 'frequencyrange_3');">
                                </div>
                                <div class="col-3"><h6><label id="frequencyrange_3" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

            </div>
            <div class="col-md-4 small-font">
                <!-- Risk Assessment Button -->
                <button id="risk-assessment-btn_3" type="button" class="btn btn-primary" onclick="executeRiskAssessment(this.id, 'loadingSpinner3')">
                    <i class="bi bi-play-fill mr-2"></i>Execute Risk Assessment
                </button>

                <!-- Add this HTML element where you want to display the loading spinner -->
                <div id="loadingSpinner3" class="spinner-border" role="status" style="display: none;">
                  <span class="visually-hidden">Loading...</span>
                </div>

                     <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label class="form-label">Risk Score: </label>
                            <input type="text" id="lblriskScore_3" name="lblriskScore_3" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Rating: </label>
                            <input type="text" id="lblriskRating_3" name="lblriskRating_3" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Estimated Event Costs (Low): </label>
                            <input type="text" id="lblriskCost_3" name="lblriskCost_3" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (High): </label>
                            <input type="text" id="lblriskCostHigh_3" name="lblriskCostHigh_3" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (Median): </label>
                            <input type="text" id="lblriskCostMedian_3" name="lblriskCostMedian_3" class="form-control" readonly><br>
                        </div>
                    </div>


                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Summary: </label>
                            <textarea id="lblriskSummary_3" name="lblriskSummary_3" class="form-control" readonly style="resize: none" rows="3"></textarea>
                        </div>
                    </div>


                </div>
            </div>
        </div>
        <div class="tab-pane" id="scenario4">
          <!-- Scenario 4 controls -->
            <div class="row">
          <div class="col-md-4 small-font">
                <input type="hidden" name="hdnScenarioID_4" id="hdnScenarioID_4">
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                      <label for="txtScenarioDescription_4" class="form-control border-0 align-text-bottom small-font" data-bs-toggle="modal" data-bs-target="#scenarioModal">Scenario Description (click for table)</label>
                      <textarea class="form-control small-font" name="txtScenarioDescription_4" id="txtScenarioDescription_4" rows="3" style="resize: none; word-wrap: normal" onchange="setRiskAssessmentRefreshRequired(4)"></textarea>
                </div>
              </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="selectOutage_4" class="form-control border-0 small-font">Production Outage</label>
                                  <select id="selectOutage_4" name="selectOutage_4" class="form-control small-font">
                                    <option value="N/A">-- Select Outage --</option>
                                    <option value="Yes">Yes</option>
                                      <option value="No">No</option>
                                  </select>
                            </div>
                            <div class="col-md-6">
                                <label for="outage_4" class="form-control border-0 small-font">Outage Length (in hours):</label>
                                <input type="number" id="outage_4" name="outage_4" min="0" max="100" class="form-control">
                            </div>
                        </div>
                    </div>
                  </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                      <label for="selectThreat_4" class="form-control border-0">Threat Source</label>
                      <select id="selectThreat_4" name="selectThreat_4" class="form-control small-font">
                        <option value="">-- Select Threat Source --</option>
                        {% for threatsources in threatsources %}
                            <option value="{{ threatsources.ThreatSource}}">{{ threatsources.ThreatSource }}</option>
                        {% endfor %}
                      </select>
                </div>
              </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                      <label for="selectTactics_4" class="form-control border-0">Threat Tactics (Mitre)</label>
                      <select id="selectTactics_4" name="selectTactics_4" class="form-control small-font">
                        <option value="">-- Select Threat Tactics --</option>
                        {% for mitreTactics in mitreTactics %}
                            <option value="{{ mitreTactics.tactic}}">{{ mitreTactics.tactic }}</option>
                        {% endfor %}
                      </select>
                </div>
              </div>
              <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="txtAssets_4" class="form-control border-0 align-text-bottom">Asset Name/s</label>
                    <textarea class="form-control" name="txtAssets_4" id="txtAssets_4" rows="3" style="resize: none; word-wrap: normal" placeholder="Add asset names relevant to the scenario..."></textarea>
                </div>
              </div>

          </div>
            <div class="col-md-4 small-font">
               <h5>Business Impact Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#safetyModal_4" data-bs-placement="top" style="cursor: pointer">Safety</label></div>
                                <div class="col-7">
                                    <label for="range_safety_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_safety_4" name="range_safety_4" onchange="initSlider('range_safety_4', 'safetyrange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><label id="safetyrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for life rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#lifeModal_4" data-bs-placement="top" style="cursor: pointer">Life</label></div>
                                <div class="col-7">
                                    <label for="range_life_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_life_4" name="range_life_4" onchange="initSlider('range_life_4', 'liferange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="liferange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#productionModal_4" data-bs-placement="top" style="cursor: pointer">Production</label></div>
                                <div class="col-7">
                                    <label for="range_production_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_production_4" name="range_production_4" onchange="initSlider('range_production_4', 'productionrange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="productionrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                             <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#financeModal_4" data-bs-placement="top" style="cursor: pointer">Financial</label></div>
                                <div class="col-7">
                                    <label for="range_finance_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_finance_4" name="range_finance_4" onchange="initSlider('range_finance_4', 'financerange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="financerange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#reputationModal_4" data-bs-placement="top" style="cursor: pointer">Reputation</label></div>
                                <div class="col-7">
                                    <label for="range_reputation_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_reputation_4" name="range_reputation_4" onchange="initSlider('range_reputation_4', 'reputationrange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="reputationrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for environment impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#environmentModal_4" data-bs-placement="top" style="cursor: pointer">Environment</label></div>
                                <div class="col-7">
                                    <label for="range_environment_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_environment_4" name="range_environment_4" onchange="initSlider('range_environment_4', 'environmentrange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="environmentrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for regulatory impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#regulationModal_4" data-bs-placement="top" style="cursor: pointer">Regulatory</label></div>
                                <div class="col-7">
                                    <label for="range_regulatory_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_regulatory_4" name="range_regulatory_4" onchange="initSlider('range_regulatory_4', 'regulatoryrange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="regulatoryrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#dataModal_4" data-bs-placement="top" style="cursor: pointer">Data/IP</label></div>
                                <div class="col-7">
                                    <label for="range_data_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_data_4" name="range_data_4" onchange="initSlider('range_data_4', 'datarange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="datarange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#supplyModal_4" data-bs-placement="top" style="cursor: pointer">Supply Chain</label></div>
                                <div class="col-7">
                                    <label for="range_supply_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_supply_4" name="range_supply_4" onchange="initSlider('range_supply_4', 'supplyrange_4');setRiskAssessmentRefreshRequired(4);">
                                </div>
                                <div class="col-3"><h6><label id="supplyrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <br>
                <h5>Vulnerability and Likelihood Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for vulnerability rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#vulnModal_4"  data-bs-placement="top" style="cursor: pointer">Vulnerability</label></div>
                                <div class="col-7">
                                    <label for="range_vuln_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_vuln_4" name="range_vuln_4" onchange="initSlider('range_vuln_4', 'vulnrange_4')">
                                </div>
                                <div class="col-3"><label id="vulnrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to estimate the danger to life of the selected scenario">Threat</label></div>
                                <div class="col-7">
                                    <label for="range_threat_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_threat_4" name="range_threat_4" onchange="initSlider('range_threat_4', 'threatrange_4');">
                                </div>
                                <div class="col-3"><h6><label id="threatrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for asset status-->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to indicate asset status">Asset Status</label></div>
                                <div class="col-7">
                                    <label for="range_frequency_4"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_frequency_4" name="range_frequency_4" onchange="initFrequencySlider('range_frequency_4', 'frequencyrange_4');">
                                </div>
                                <div class="col-3"><h6><label id="frequencyrange_4" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>

            </div>
            <div class="col-md-4 small-font">
                <!-- Risk Assessment Button -->
                <button id="risk-assessment-btn_4" type="button" class="btn btn-primary" onclick="executeRiskAssessment(this.id, 'loadingSpinner4')">
                    <i class="bi bi-play-fill mr-2"></i>Execute Risk Assessment
                </button>

                <!-- Add this HTML element where you want to display the loading spinner -->
                <div id="loadingSpinner4" class="spinner-border" role="status" style="display: none;">
                  <span class="visually-hidden">Loading...</span>
                </div>

                     <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label class="form-label">Risk Score: </label>
                            <input type="text" id="lblriskScore_4" name="lblriskScore_4" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Rating: </label>
                            <input type="text" id="lblriskRating_4" name="lblriskRating_4" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Estimated Event Costs (Low): </label>
                            <input type="text" id="lblriskCost_4" name="lblriskCost_4" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (High): </label>
                            <input type="text" id="lblriskCostHigh_4" name="lblriskCostHigh_4" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (Median): </label>
                            <input type="text" id="lblriskCostMedian_4" name="lblriskCostMedian_4" class="form-control" readonly><br>
                        </div>
                    </div>


                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Summary: </label>
                            <textarea id="lblriskSummary_4" name="lblriskSummary_4" class="form-control" readonly style="resize: none" rows="3"></textarea>
                        </div>
                    </div>


                </div>
            </div>
        </div>
        <div class="tab-pane" id="scenario5">
          <!-- Scenario 5 controls -->
            <div class="row">
            <div class="col-md-4 small-font">
            <input type="hidden" name="hdnScenarioID_5" id="hdnScenarioID_5">
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                  <label for="txtScenarioDescription_5" class="form-control border-0 align-text-bottom small-font" data-bs-toggle="modal" data-bs-target="#scenarioModal">Scenario Description (click for table)</label>

                  <textarea class="form-control small-font" name="txtScenarioDescription_5" id="txtScenarioDescription_5" rows="3" style="resize: none; word-wrap: normal" onchange="setRiskAssessmentRefreshRequired(5)"></textarea>
                </div>
            </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <label for="selectOutage_5" class="form-control border-0 small-font">Production Outage</label>
                              <select id="selectOutage_5" name="selectOutage_5" class="form-control small-font">
                                <option value="N/A">-- Select Outage --</option>
                                <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                              </select>
                        </div>
                        <div class="col-md-6">
                            <label for="outage_5" class="form-control border-0 small-font">Outage Length (in hours):</label>
                            <input type="number" id="outage_5" name="outage_5" min="0" max="100" class="form-control">
                        </div>
                    </div>
                </div>
              </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                  <label for="selectThreat_5" class="form-control border-0">Threat Source</label>
                  <select id="selectThreat_5" name="selectThreat_5" class="form-control small-font">
                    <option value="">-- Select Threat Source --</option>
                    {% for threatsources in threatsources %}
                        <option value="{{ threatsources.ThreatSource}}">{{ threatsources.ThreatSource }}</option>
                    {% endfor %}
                  </select>
                </div>
            </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                  <label for="selectTactics_5" class="form-control border-0 small-font">Threat Tactics (Mitre)</label>
                  <select id="selectTactics_5" name="selectTactics_5" class="form-control">
                    <option value="">-- Select Threat Tactics --</option>
                    {% for mitreTactics in mitreTactics %}
                        <option value="{{ mitreTactics.tactic}}">{{ mitreTactics.tactic }}</option>
                    {% endfor %}
                  </select>
                </div>
            </div>
            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                <div class="card-body">
                    <label for="txtAssets_5" class="form-control border-0 align-text-bottom">Asset Name/s</label>
                    <textarea class="form-control" name="txtAssets_5" id="txtAssets_5" rows="3" style="resize: none; word-wrap: normal" placeholder="Add asset names relevant to the scenario..."></textarea>
                </div>
            </div>

          </div>
            <div class="col-md-4 small-font">

                <h5>Business Impact Analysis</h5>
                    <!--slider for safety rating -->
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#safetyModal_5" data-bs-placement="top" style="cursor: pointer">Safety</label></div>
                                <div class="col-7">
                                    <label for="range_safety_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_safety_5" name="range_safety_5" onchange="initSlider('range_safety_5', 'safetyrange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><label id="safetyrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for life rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#lifeModal_5" data-bs-placement="top" style="cursor: pointer">Life</label></div>
                                <div class="col-7">
                                    <label for="range_life_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_life_5" name="range_life_5" onchange="initSlider('range_life_5', 'liferange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="liferange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for production rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#productionModal_5" data-bs-placement="top" style="cursor: pointer">Production</label></div>
                                <div class="col-7">
                                    <label for="range_production_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_production_5" name="range_production_5" onchange="initSlider('range_production_5', 'productionrange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="productionrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                             <!--slider for finance rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#financeModal_5" data-bs-placement="top" style="cursor: pointer">Financial</label></div>
                                <div class="col-7">
                                    <label for="range_finance_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_finance_5" name="range_finance_5" onchange="initSlider('range_finance_5', 'financerange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="financerange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for reputation rating -->
                             <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#reputationModal_5" data-bs-placement="top" style="cursor: pointer">Reputation</label></div>
                                    <div class="col-7">
                                        <label for="range_reputation_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_reputation_5" name="range_reputation_5" onchange="initSlider('range_reputation_5', 'reputationrange_5');setRiskAssessmentRefreshRequired(5);">
                                    </div>
                                <div class="col-3"><h6><label id="reputationrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for environment impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#environmentModal_5" data-bs-placement="top" style="cursor: pointer">Environment</label></div>
                                <div class="col-7">
                                    <label for="range_environment_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_environment_5" name="range_environment_5" onchange="initSlider('range_environment_5', 'environmentrange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="environmentrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for regulatory impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#regulationModal_5" data-bs-placement="top" style="cursor: pointer">Regulatory</label></div>
                                <div class="col-7">
                                    <label for="range_regulatory_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_regulatory_5" name="range_regulatory_5" onchange="initSlider('range_regulatory_5', 'regulatoryrange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="regulatoryrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#dataModal_3" data-bs-placement="top" style="cursor: pointer">Data/IP</label></div>
                                <div class="col-7">
                                    <label for="range_data_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_data_5" name="range_data_5" onchange="initSlider('range_data_5', 'datarange_5'); setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="datarange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for data impact rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#supplyModal_5" data-bs-placement="top" style="cursor: pointer">Supply Chain</label></div>
                                <div class="col-7">
                                    <label for="range_supply_1"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_supply_5" name="range_supply_5" onchange="initSlider('range_supply_5', 'supplyrange_5');setRiskAssessmentRefreshRequired(5);">
                                </div>
                                <div class="col-3"><h6><label id="supplyrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                <br>
                <h5>Vulnerability and Likelihood Analysis</h5>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for vulnerability rating -->
                            <div class="slider-container d-flex align-items-center" >
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#vulnModal_5"  data-bs-placement="top" style="cursor: pointer">Vulnerability</label></div>
                                <div class="col-7">
                                    <label for="range_vuln_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_vuln_5" name="range_vuln_5" onchange="initSlider('range_vuln_5', 'vulnrange_5')">
                                </div>
                                <div class="col-3"><label id="vulnrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for safety rating -->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to estimate the danger to life of the selected scenario">Threat</label></div>
                                <div class="col-7">
                                    <label for="range_threat_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_threat_5" name="range_threat_5" onchange="initSlider('range_threat_5', 'threatrange_5');">
                                </div>
                                <div class="col-3"><h6><label id="threatrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <!--slider for frequency-->
                            <div class="slider-container d-flex align-items-center">
                                <div class="col-2"><label class="small-font d-flex align-items-center " data-bs-toggle="tooltip" data-bs-placement="top" title="Use the slider to indicate asset status">Asset Status</label></div>
                                <div class="col-7">
                                    <label for="range_frequency_5"></label><input type="range" min="1" max="10" value="1" class="form-range" id="range_frequency_5" name="range_frequency_5" onchange="initFrequencySlider('range_frequency_5', 'frequencyrange_5');">
                                </div>
                                <div class="col-3"><h6><label id="frequencyrange_5" class="form-label text-center d-flex align-items-center justify-content-center small-font "></label></h6></div>
                            </div>
                        </div>
                    </div>


            </div>
            <div class="col-md-4 small-font">
                <!-- Risk Assessment Button -->
                <button id="risk-assessment-btn_5" type="button" class="btn btn-primary" onclick="executeRiskAssessment(this.id, 'loadingSpinner5');">
                    <i class="bi bi-play-fill mr-2"></i>Execute Risk Assessment
                </button>

                <!-- Add this HTML element where you want to display the loading spinner -->
                <div id="loadingSpinner5" class="spinner-border" role="status" style="display: none;">
                  <span class="visually-hidden">Loading...</span>
                </div>

                     <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label class="form-label">Risk Score: </label>
                            <input type="text" id="lblriskScore_5" name="lblriskScore_5" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Rating: </label>
                            <input type="text" id="lblriskRating_5" name="lblriskRating_5" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Estimated Event Costs (Low): </label>
                            <input type="text" id="lblriskCost_5" name="lblriskCost_5" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (High): </label>
                            <input type="text" id="lblriskCostHigh_5" name="lblriskCostHigh_5" class="form-control" readonly><br>
                            <label class="form-label">Estimated Event Costs (Median): </label>
                            <input type="text" id="lblriskCostMedian_5" name="lblriskCostMedian_5" class="form-control" readonly><br>
                        </div>
                    </div>


                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <label class="form-label">Risk Summary: </label>
                            <textarea id="lblriskSummary_5" name="lblriskSummary_5" class="form-control" readonly style="resize: none" rows="3"></textarea>
                        </div>
                    </div>


                </div>
            </div>
        </div>
      </div>
    </div>
</div>

    <div class="col-md-1 bg-black"></div>
</div>


<div class="row">
    <div class="col-md-1 bg-black"></div>
    <div class="col-md-10 ">
     <div class="row" style="background-color: darkgray; height: 15px"></div>
   </div>
    <div class="col-md-1 bg-black"></div>
</div> <!-- dark grey stripe -->

<!-- table for actions -->
<div class="row">
    <div class="col-md-1 bg-black"></div>

    <div class="col-md-10" style="background-color: white">
        <br>
        <label for="actiontable" class="form-label">Actions for this Risk Assessment</label>
        <table id="actiontable" class="table table-striped table-bordered small-font">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Status</th>
                    <th>Priority</th>
                    <th>Owner</th>
                    <!-- Add more <th> elements for each field in the RAWorksheet model -->
                </tr>
            </thead>
            <tbody>
                <!-- Rows will be populated by the JavaScript function -->
            </tbody>
        </table>

    </div> <!-- table view of existing risk assessments -->

    <div class="col-md-1 bg-black"></div>
</div>




<!--modal forms -->

<div class="modal fade" id="scenarioModal" tabindex="-1" aria-labelledby="scenarioModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="scenarioModalLabel">Select Scenario</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="table-wrap border border-warning rounded p-3" style="border: 3px #97979A; border-radius: 10px; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);  padding: 20px; background-color: white;">
            <table id="scenarioList" class="table table-hover table-bordered small small-font overflow-auto" style="width: 100%; background-color: white">
                <thead>
                    <tr>
                        <th>Scenario</th>
                    </tr>
                </thead>
                <tbody id="scenarioListBody">
                    {% for scenario in scenarios %}
                    <tr onclick="selectScenario(this)">
                        <td>{{ scenario.Scenario }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <script>
            $(document).ready(function() {
                $('#scenarioList').DataTable();
            });
        </script>

      </div>
    </div>
  </div>
</div>
<script>
    function selectScenario(row) {
    // Get the scenario text from the clicked row
    var scenarioText = $(row).find('td').text();

    // Determine the active tab
    var activeTab = $('.nav-tabs .active').attr('id');

    // Determine the corresponding textarea based on the active tab
    var textareaId;
    switch (activeTab) {
        case 'scenario1-tab':
            textareaId = 'txtScenarioDescription_1';
            break;
        case 'scenario2-tab':
            textareaId = 'txtScenarioDescription_2';
            break;
        case 'scenario3-tab':
            textareaId = 'txtScenarioDescription_3';
            break;
        case 'scenario4-tab':
            textareaId = 'txtScenarioDescription_4';
            break;
        case 'scenario5-tab':
            textareaId = 'txtScenarioDescription_5';
            break;
    }

    // Populate the corresponding textarea
    $('#' + textareaId).val(scenarioText);

    // Close the modal
    $('#scenarioModal').modal('hide');
}

</script>

<!-- safety ratings -->
<div class="modal fade" id="safetyModal_1" tabindex="-1" aria-labelledby="safetyModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="safetyModal_1_Label">Justification for Scenario 1 Safety Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtSafetyJustify_1" name="txtSafetyJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="safetyModal_2" tabindex="-1" aria-labelledby="safetyModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="safetyModal_2_Label">Justification for Scenario 2 Safety Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtSafetyJustify_2" name="txtSafetyJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="safetyModal_3" tabindex="-1" aria-labelledby="safetyModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="safetyModal_3_Label">Justification for Scenario 3 Safety Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtSafetyJustify_3" name="txtSafetyJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="safetyModal_4" tabindex="-1" aria-labelledby="safetyModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="safetyModal_4_Label">Justification for Scenario 4 Safety Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtSafetyJustify_4" name="txtSafetyJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="safetyModal_5" tabindex="-1" aria-labelledby="safetyModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="safetyModal_5_Label">Justification for Scenario 5 Safety Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtSafetyJustify_5" name="txtSafetyJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- life ratings -->
<div class="modal fade" id="lifeModal_1" tabindex="-1" aria-labelledby="lifeModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="lifeModal_1_Label">Justification for Scenario 1 Danger-to-Life Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtlifeJustify_1" name="txtlifeJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="lifeModal_2" tabindex="-1" aria-labelledby="lifeModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="lifeModal_2_Label">Justification for Scenario 2 Danger-to-Life Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtlifeJustify_2" name="txtlifeJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="lifeModal_3" tabindex="-1" aria-labelledby="lifeModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="lifeModal_3_Label">Justification for Scenario 3 Danger-to-Life Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtlifeJustify_3" name="txtlifeJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="lifeModal_4" tabindex="-1" aria-labelledby="lifeModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="lifeModal_4_Label">Justification for Scenario 4 Danger-to-Life Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtlifeJustify_4" name="txtlifeJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="lifeModal_5" tabindex="-1" aria-labelledby="lifeModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="lifeModal_5_Label">Justification for Scenario 5 Danger-to-Life Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtlifeJustify_5" name="txtlifeJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Production impact justifications -->
<div class="modal fade" id="productionModal_1" tabindex="-1" aria-labelledby="productionModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productionModal_1_Label">Justification for Scenario 1 Production Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtproductionJustify_1" name="txtproductionJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="productionModal_2" tabindex="-1" aria-labelledby="productionModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productionModal_2_Label">Justification for Scenario 2 Production Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtproductionJustify_2" name="txtproductionJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="productionModal_3" tabindex="-1" aria-labelledby="productionModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productionModal_3_Label">Justification for Scenario 3 Production Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtproductionJustify_3" name="txtproductionJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="productionModal_4" tabindex="-1" aria-labelledby="productionModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productionModal_4_Label">Justification for Scenario 4 Production Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtproductionJustify_4" name="txtproductionJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="productionModal_5" tabindex="-1" aria-labelledby="productionModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productionModal_5_Label">Justification for Scenario 5 Production Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtproductionJustify_5" name="txtproductionJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Financial justification modals -->
<div class="modal fade" id="financeModal_1" tabindex="-1" aria-labelledby="financeModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="financeModal_1_Label">Justification for Scenario 1 Finance Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtfinanceJustify_1" name="txtfinanceJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="financeModal_2" tabindex="-1" aria-labelledby="financeModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="financeModal_2_Label">Justification for Scenario 2 Finance Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtfinanceJustify_2" name="txtfinanceJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="financeModal_3" tabindex="-1" aria-labelledby="financeModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="financeModal_3_Label">Justification for Scenario 3 Finance Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtfinanceJustify_3" name="txtfinanceJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="financeModal_4" tabindex="-1" aria-labelledby="financeModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="financeModal_4_Label">Justification for Scenario 4 Finance Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtfinanceJustify_4" name="txtfinanceJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="financeModal_5" tabindex="-1" aria-labelledby="financeModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="financeModal_5_Label">Justification for Scenario 5 Finance Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtfinanceJustify_5" name="txtfinanceJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Reputation justification modals -->
<div class="modal fade" id="reputationModal_1" tabindex="-1" aria-labelledby="reputationModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="reputationModal_1_Label">Justification for Scenario 1 Reputation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtreputationJustify_1" name="txtreputationJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="reputationModal_2" tabindex="-1" aria-labelledby="reputationModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="reputationModal_2_Label">Justification for Scenario 2 Reputation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtreputationJustify_2" name="txtreputationJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="reputationModal_3" tabindex="-1" aria-labelledby="reputationModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="reputationModal_3_Label">Justification for Scenario 3 Reputation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtreputationJustify_3" name="txtreputationJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="reputationModal_4" tabindex="-1" aria-labelledby="reputationModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="reputationModal_4_Label">Justification for Scenario 4 Reputation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtreputationJustify_4" name="txtreputationJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="reputationModal_5" tabindex="-1" aria-labelledby="reputationModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="reputationModal_5_Label">Justification for Scenario 5 Reputation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtreputationJustify_5" name="txtreputationJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Environment justification modals -->
<div class="modal fade" id="environmentModal_1" tabindex="-1" aria-labelledby="environmentModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="environmentModal_1_Label">Justification for Scenario 1 Environment Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtenvironmentJustify_1" name="txtenvironmentJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="environmentModal_2" tabindex="-1" aria-labelledby="environmentModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="environmentModal_2_Label">Justification for Scenario 2 Environment Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtenvironmentJustify_2" name="txtenvironmentJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="environmentModal_3" tabindex="-1" aria-labelledby="environmentModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="environmentModal_3_Label">Justification for Scenario 3 Environment Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtenvironmentJustify_3" name="txtenvironmentJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="environmentModal_4" tabindex="-1" aria-labelledby="environmentModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="environmentModal_4_Label">Justification for Scenario 4 Environment Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtenvironmentJustify_4" name="txtenvironmentJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="environmentModal_5" tabindex="-1" aria-labelledby="environmentModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="environmentModal_5_Label">Justification for Scenario 5 Environment Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtenvironmentJustify_5" name="txtenvironmentJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Regulatory justification modals -->
<div class="modal fade" id="regulationModal_1" tabindex="-1" aria-labelledby="regulationModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="regulationModal_1_Label">Justification for Scenario 1 Regulation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtregulationJustify_1" name="txtregulationJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="regulationModal_2" tabindex="-1" aria-labelledby="regulationModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="regulationModal_2_Label">Justification for Scenario 2 Regulation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtregulationJustify_2" name="txtregulationJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="regulationModal_3" tabindex="-1" aria-labelledby="regulationModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="regulationModal_3_Label">Justification for Scenario 3 Regulation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtregulationJustify_3" name="txtregulationJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="regulationModal_4" tabindex="-1" aria-labelledby="regulationModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="regulationModal_4_Label">Justification for Scenario 4 Regulation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtregulationJustify_4" name="txtregulationJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="regulationModal_5" tabindex="-1" aria-labelledby="regulationModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="regulationModal_5_Label">Justification for Scenario 5 Regulation Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtregulationJustify_5" name="txtregulationJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Data justification modals -->
<div class="modal fade" id="dataModal_1" tabindex="-1" aria-labelledby="dataModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="dataModal_1_Label">Justification for Scenario 1 Data Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtdataJustify_1" name="txtdataJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="dataModal_2" tabindex="-1" aria-labelledby="dataModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="dataModal_2_Label">Justification for Scenario 2 Data Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtdataJustify_2" name="txtdataJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="dataModal_3" tabindex="-1" aria-labelledby="dataModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="dataModal_3_Label">Justification for Scenario 3 Data Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtdataJustify_3" name="txtdataJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="dataModal_4" tabindex="-1" aria-labelledby="dataModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="dataModal_4_Label">Justification for Scenario 4 Data Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtdataJustify_4" name="txtdataJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="dataModal_5" tabindex="-1" aria-labelledby="dataModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="dataModal_5_Label">Justification for Scenario 5 Data Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtdataJustify_5" name="txtdataJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


<!-- Supply Chain justification modals -->
<div class="modal fade" id="supplyModal_1" tabindex="-1" aria-labelledby="supplyModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="supplyModal_1_Label">Justification for Scenario 1 Supply Chain Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtsupplyJustify_1" name="txtsupplyJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="supplyModal_2" tabindex="-1" aria-labelledby="supplyModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="supplyModal_2_Label">Justification for Scenario 2 Supply Chain Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtsupplyJustify_2" name="txtsupplyJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="supplyModal_3" tabindex="-1" aria-labelledby="supplyModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="supplyModal_3_Label">Justification for Scenario 3 Supply Chain Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtsupplyJustify_3" name="txtsupplyJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="supplyModal_4" tabindex="-1" aria-labelledby="supplyModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="supplyModal_4_Label">Justification for Scenario 4 Supply Chain Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtsupplyJustify_4" name="txtsupplyJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="supplyModal_5" tabindex="-1" aria-labelledby="supplyModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="supplyModal_5_Label">Justification for Scenario 5 Supply Chain Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtsupplyJustify_5" name="txtsupplyJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Vulnerability justification modals -->
<div class="modal fade" id="vulnModal_1" tabindex="-1" aria-labelledby="vulnModal_1_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="vulnModal_1_Label">Justification for Scenario 1 Vulnerability Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtvulnJustify_1" name="txtvulnJustify_1" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="vulnModal_2" tabindex="-1" aria-labelledby="vulnModal_2_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="vulnModal_2_Label">Justification for Scenario 2 Vulnerability Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtvulnJustify_2" name="txtvulnJustify_2" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="vulnModal_3" tabindex="-1" aria-labelledby="vulnModal_3_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="vulnModal_3_Label">Justification for Scenario 3 Vulnerability Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtvulnJustify_3" name="txtvulnJustify_3" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="vulnModal_4" tabindex="-1" aria-labelledby="vulnModal_4_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="vulnModal_4_Label">Justification for Scenario 4 Vulnerability Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtvulnJustify_4" name="txtvulnJustify_4" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="vulnModal_5" tabindex="-1" aria-labelledby="vulnModal_5_Label" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="vulnModal_5_Label">Justification for Scenario 5 Vulnerability Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="txtvulnJustify_5" name="txtvulnJustify_5" class="form-control" rows="3" style="resize: none"></textarea>
        <button type="button" class="btn btn-secondary mt-3" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



</form>

<!-- RAActionsModal.html -->
<div class="modal fade" id="RAActionsModal" tabindex="-1" aria-labelledby="RAActionsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="RAActionsModalLabel">Mitigate Risk:</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
        <div class="modal-body">
            <form id="raActionsForm">
                {% csrf_token %}
                <input type="hidden" name="hdnphaID" id="hdnphaID" value="0">
                <input type="hidden" name="hdntxtModalRAW" id="hdntxtModalRAW">

                <!-- Action Title -->
                <div class="mb-3">
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label for="actionTitle" class="form-label">Headline</label>
                            <input type="text" class="form-control" id="actionTitle" name="actionTitle" required>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-7">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionOwner" class="form-label">Risk Owner</label>
                                    <input type="text" class="form-control" id="actionOwner" name="actionOwner" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionDate" class="form-label">Action Date</label>
                                    <input type="date" class="form-control" id="actionDate" name="actionDate" required>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionEffort" class="form-label">Effort Level:</label>
                                    <Select class="form-control" id="actionEffort" name="actionEffort">
                                            <option value="">-- Select Costs --</option>
                                            <option value="Low">Low</option>
                                            <option value="Medium">Medium</option>
                                            <option value="High">High</option>
                                            <option value="Very High">Very High</option>
                                        </select>
                                </div>
                                </div>
                            </div>
                        </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionDifficulty" class="form-label">Difficulty Level</label>
                                    <Select class="form-control" id="actionDifficulty" name="actionDifficulty">
                                            <option value="">-- Select Costs --</option>
                                            <option value="Low">Low</option>
                                            <option value="Medium">Medium</option>
                                            <option value="High">High</option>
                                            <option value="Very High">Very High</option>
                                        </select>

                                </div>
                            </div>
                        </div>
                    </div>
                    </div>


                <div class="row">
                    <div class="col-md-4">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionCost" class="form-label">Estimated Cost</label>
                                    <Select class="form-control" id="actionCost" name="actionCost">
                                            <option value="">-- Select Costs --</option>
                                            <option value="Low">Low</option>
                                            <option value="Medium">Medium</option>
                                            <option value="High">High</option>
                                            <option value="Very High">Very High</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionAffinity" class="form-label">Risk Mitigation</label>
                                    <Select class="form-control" id="actionAffinity" name="actionAffinity">
                                            <option value="">-- Select Costs --</option>
                                            <option value="Low">Low</option>
                                            <option value="Medium">Medium</option>
                                            <option value="High">High</option>
                                            <option value="Very High">Very High</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionStatus" class="form-label">Status</label>
                                    <input type="text" class="form-control" id="actionStatus" name="actionStatus" readonly value="Open">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label for="actionDescription" class="form-label">Description</label>
                            <textarea id="actionDescription" name="actionDescription" class="form-control" rows="3" style="resize: none"></textarea>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-7">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionPriority" class="form-label">Urgency</label>
                                        <select class="form-control" id="actionPriority" name="actionPriority">
                                            <option value="0">-- Select Urgency --</option>
                                            <option value="1">Low</option>
                                            <option value="2">Medium</option>
                                            <option value="3">High</option>
                                            <option value="4">Critical</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="actionDueDate" class="form-label">Target Date</label>
                                    <input type="date" class="form-control" id="actionDueDate" name="actionDueDate">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Action Assets -->
                <div class="mb-3">
                    <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                        <div class="card-body">
                            <label for="actionAssets" class="form-label">Action Assets</label>
                            <textarea id="actionAssets" name="actionAssets" class="form-control" rows="3" style="resize: none"></textarea>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="outageSIS" class="form-label">Safety (SIS) Outage:</label>
                                        <select class="form-control" id="outageSIS" name="outageSIS">
                                            <option value="">-- Select Option --</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="outageICS" class="form-label">Control System (SCADA/ICS) Outage:</label>
                                        <select class="form-control" id="outageICS" name="outageICS">
                                            <option value="">-- Select Option --</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="outageEMS" class="form-label">Environmental (EMS) Outage:</label>
                                        <select class="form-control" id="outageEMS" name="outageEMS">
                                            <option value="">-- Select Option --</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <!-- Action Owner -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="outageIT" class="form-label">IT Outage:</label>
                                        <select class="form-control" id="outageIT" name="outageIT">
                                            <option value="">-- Select Option --</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="outagePS" class="form-label">Physical Security Outage:</label>
                                        <select class="form-control" id="outagePS" name="outagePS">
                                            <option value="">-- Select Option --</option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <!-- Action Date -->
                        <div class="mb-3">
                            <div class="card mb-3 shadow-sm"> <!-- Bootstrap card with shadow -->
                                <div class="card-body">
                                    <label for="outageWWW" class="form-label">Internet Outage:</label>
                                        <select class="form-control" id="outageWWW" name="outageWWW">
                                            <option value="0">-- Select Option --</option>
                                            <option value="1">Yes</option>
                                            <option value="2">No</option>
                                        </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="button" class="btn btn-primary" onclick="submitRAActionForm();">Save</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </form>
        </div>
        <!-- ... (rest of the modal code) ... -->

    </div>
  </div>
</div>

<script>
    function getCookie(name) {
        let value = "; " + document.cookie;
        let parts = value.split("; " + name + "=");
        if (parts.length == 2) return parts.pop().split(";").shift();
    }

    $.ajaxSetup({
        headers: { "X-CSRFToken": getCookie("csrftoken") }
    });

    function submitRAActionForm() {
        $.ajax({
            type: "POST",
            url: "{% url 'OTRisk:save_ra_action' %}",
            data: $("#raActionsForm").serialize(),
            success: function(response) {
                if (response.status == "success") {
                    $("#RAActionsModal").modal('hide');
                    // Optionally, show a success message or perform other actions.
                } else {
                    alert("Error saving data!");
                }
            }
        });
    }
</script>






<script>

        // Function to assign value with error handling
        function assignValueWithValidation(targetId, value) {
          const targetElement = document.getElementById(targetId);

          if (value !== null && value !== undefined) {
            targetElement.value = value;
          } else {
            console.error(`Invalid value for ${targetId}`);
          }
        }

        // AJAX function to call the Django view
        function executeRiskAssessment(buttonID, spinnerID) {


            $('#' + spinnerID).show();
            var buttonNumber = buttonID.split('_')[1];
            var scenarioCountTextbox = document.querySelector('input[name="scenarioCount"]');

            // Check if the textbox value is null, empty, or less than buttonNumber
            if (!scenarioCountTextbox.value || scenarioCountTextbox.value < buttonNumber) {
                // Ensure the value does not exceed 5
                scenarioCountTextbox.value = Math.min(buttonNumber, 5);
            }
            setRiskAssessmentRefreshNotRequired(buttonNumber);
            // Gather the necessary data for the AJAX request (impact scores and scenario information)
            var scenario = document.getElementById('txtScenarioDescription_' + buttonNumber).value;
            var industry = document.getElementById('selectIndustry').value;
            var facilityType = document.getElementById('selectFacility').value;
            var revenue = document.getElementById('txtRevenue').value;

            if (!scenario || !industry || !facilityType || !revenue) {
                alert("Not enough data to execute risk assessment");
                $('#' + spinnerID).hide();
                return; // Exits the function
            }

            var safetyImpact = document.getElementById('range_safety_' + buttonNumber).value;
            var lifeImpact = document.getElementById('range_life_' + buttonNumber).value;
            var productionImpact = document.getElementById('range_production_' + buttonNumber).value;
            var financialImpact = document.getElementById('range_finance_' + buttonNumber).value;
            var reputationImpact = document.getElementById('range_reputation_' + buttonNumber).value;
            var environmentImpact = document.getElementById('range_environment_' + buttonNumber).value;
            var regulatoryImpact = document.getElementById('range_regulatory_' + buttonNumber).value;
            var supplyImpact = document.getElementById('range_supply_' + buttonNumber).value;
            var dataImpact = document.getElementById('range_data_' + buttonNumber).value;
            var threatSource = document.getElementById('selectThreat_' + buttonNumber).value;
            var threatTactic = document.getElementById('selectTactics_' + buttonNumber).value;
            var vulnerabilityExposure = document.getElementById('range_vuln_' + buttonNumber).value;
            var threatExposure = document.getElementById('range_threat_' + buttonNumber).value;
            var assetStatus = document.getElementById('range_frequency_' + buttonNumber).value;
            var insurance = document.getElementById('txtInsurance').value;
            var deductable = document.getElementById('txtDeductable').value;
            var outage = document.getElementById('selectOutage_' + buttonNumber).value;
            var outageLength = document.getElementById('outage_' + buttonNumber).value;

            // Make the AJAX call to the Django view using a separate endpoint for risk assessment
            $.ajax({
                type: "GET",
                url: "{% url 'OTRisk:openai_assess_risk' %}",  // URL for the Django view
                data: {
                    // Pass the impact scores and scenario information as parameters
                    safety_impact: safetyImpact,
                    life_impact: lifeImpact,
                    production_impact: productionImpact,
                    financial_impact: financialImpact,
                    reputation_impact: reputationImpact,
                    environment_impact: environmentImpact,
                    regulatory_impact: regulatoryImpact,
                    data_impact: dataImpact,
                    supply_impact: supplyImpact,
                    threat_source: threatSource,
                    threat_tactic: threatTactic,
                    vulnerability_exposure: vulnerabilityExposure,
                    threat_exposure: threatExposure,
                    industry: industry,
                    facility_type: facilityType,
                    scenario: scenario,
                    assetStatus: assetStatus,
                    revenue: revenue,
                    insurance: insurance,
                    deductable: deductable,
                    outage: outage,
                    outageLength: outageLength

                },
                success: function (response) {

                    // Extract the risk score and risk rating from the response
                    var riskRating = response[0];
                    var riskScore = response[1];
                    var low_estimate = response[2];
                    var high_estimate = response[3];
                    var riskSummary = response[4];
                    var median_estimate = response[5];

                    $('#lblriskScore_' +buttonNumber).val(riskScore);

                    $('#lblriskRating_' + buttonNumber).val(riskRating);
                    //$('#lblriskCost_' + buttonNumber).val(low_estimate);
                    $('#lblriskCost_' + buttonNumber).val(low_estimate.toLocaleString('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        maximumFractionDigits: 0 // To ensure no decimal point
                    }));
                    //$('#lblriskCostHigh_' + buttonNumber).val(high_estimate);
                    $('#lblriskCostHigh_' + buttonNumber).val(high_estimate.toLocaleString('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        maximumFractionDigits: 0 // To ensure no decimal point
                    }));
                    //$('#lblriskCostMedian_' + buttonNumber).val(median_estimate);
                    $('#lblriskCostMedian_' + buttonNumber).val(median_estimate.toLocaleString('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        maximumFractionDigits: 0 // To ensure no decimal point
                    }));
                    $('#lblriskSummary_' + buttonNumber).val(riskSummary);
                    $('#' + spinnerID).hide();

                    // Set the background and foreground colors based on the risk rating
                    if (riskRating.includes('Low')) {
                        $('#lblriskRating_' + buttonNumber).css('background-color', 'green');
                        $('#lblriskRating_' + buttonNumber).css('color', 'black');
                    } else if (riskRating.includes('Medium')) {
                        $('#lblriskRating_' + buttonNumber).css('background-color', 'yellow');
                        $('#lblriskRating_' + buttonNumber).css('color', 'black');
                    } else if (riskRating.includes('High')) {
                        $('#lblriskRating_' + buttonNumber).css('background-color', 'red');
                        $('#lblriskRating_' + buttonNumber).css('color', 'black');
                    } else {
                        // Default styles if the risk rating doesn't match any of the above
                        $('#lblriskRating_' + buttonNumber).css('background-color', 'white');
                        $('#lblriskRating_' + buttonNumber).css('color', 'black');
                    }
                    $('#' + spinnerID).hide();

                },
                error: function (xhr, status, error) {
                    // Handle any errors that occur during the AJAX call
                    console.error(error);
                    $('#' + spinnerID).hide();
                },
            });
        }


    document.addEventListener('DOMContentLoaded', function() {
      var rangeVuln2 = document.getElementById('range_vuln_2');
      var txtVuln2Container = document.getElementById('txtVuln_2_container');
      var txtVuln2 = document.getElementById('txtVuln_2');
      // var closeTxtVuln2 = document.getElementById('closeTxtVuln_2');

      rangeVuln2.addEventListener('click', function() {
        txtVuln2Container.style.display = 'block';
      });

      //closeTxtVuln2.addEventListener('click', function() {
       // txtVuln2Container.style.display = 'none';
     // });
    });

  // Preserve input values when switching tabs
  $(document).ready(function() {
    $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
      var target = $(e.target).attr("href"); // Get the target tab id
      var previousTab = $(e.relatedTarget).attr("href"); // Get the previous tab id

      // Store the input values of the previous tab
      $(previousTab).find(':input').each(function() {
        var inputId = $(this).attr('id');
        var inputValue = $(this).val();
        localStorage.setItem(inputId, inputValue);
      });

      // Restore the input values of the target tab
      $(target).find(':input').each(function() {
        var inputId = $(this).attr('id');
        var savedValue = localStorage.getItem(inputId);
        if (savedValue !== null) {
          $(this).val(savedValue);
        }
      });
    });
  });


$(document).ready(function(){
    $('#rawtable').dataTable( {
        "pageLength": 5,
            "lengthChange": false

    } );
});

$(document).ready(function() {
    $('#selectIndustry').select2();
});

$(document).ready(function() {
    $('#selectFacility').select2();
});

$(document).ready(function() {
    $('#selectTrigger').select2();
});

$(document).ready(function() {
    $('#selectStatus').select2();
});

//following code to load raw data and scenarios from the clicked raw record in the table
$(document).ready(function() {
    $('#rawtable').on('click', 'tbody tr', function() {
        clearValues();
        sessionStorage.setItem('scenario1id', '');
        sessionStorage.setItem('scenario2id', '');
        sessionStorage.setItem('scenario3id', '');
        sessionStorage.setItem('scenario4id', '');
        sessionStorage.setItem('scenario5id', '');

        document.getElementById("txtScenarioDescription_1").value = "";

        document.getElementById("txtScenarioDescription_2").value = "";
        document.getElementById("scenario3-tab").click();
        document.getElementById("txtScenarioDescription_3").value = "";
        document.getElementById("txtScenarioDescription_4").value = "";
        document.getElementById("txtScenarioDescription_5").value = "";
        document.getElementById("txtAssets_1").value = "";
        document.getElementById("txtAssets_2").value = "";
        document.getElementById("txtAssets_3").value = "";
        document.getElementById("txtAssets_4").value = "";
        document.getElementById("txtAssets_5").value = "";
        document.getElementById("editBtn").disabled= false;
        document.getElementById("scenario1-tab").click();

        // Get the data from the clicked row
        var title = $(this).find('td:eq(1)').text();
        var businessUnit = $(this).find('td:eq(7)').text();
        var leader = $(this).find('td:eq(8)').text();
        var facility = $(this).find('td:eq(5)').text();
        var industry = $(this).find('td:eq(6)').text();
        var trigger = $(this).find('td:eq(4)').text();
        var status = $(this).find('td:eq(2)').text();
        var insurance = $(this).data('insurance');
        var revenue = $(this).data('revenue');
        var deductable = $(this).data('deductable');
        var raw_id = $(this).find('td:eq(0)').text();
        document.getElementById("hdnRawID").value = raw_id;
        document.getElementById('hdntxtModalRAW').value = raw_id;
        sessionStorage.setItem('rawid',raw_id);
        sessionStorage.setItem('editMode','0');
        sessionStorage.setItem('addNew','0');
        sessionStorage.setItem('RATitle',title);
        sessionStorage.setItem('RABU',businessUnit);
        $('#editBtn').prop('disabled', false);

        // Dynamically set the href attribute of the link
        var newHref = "{% url 'OTRisk:rawreport' raworksheet_id=0 %}".replace('0', raw_id);
        $('#generateReportLink').attr('href', newHref);

        // Set the values of the form controls
        $('#txtTitle').val(title);
        $('#txtBU').val(businessUnit);
        $('#txtLeader').val(leader);
        $('#selectFacility').val(facility).trigger('change'); // Use .trigger('change') to update the Select2 control
        $('#selectIndustry').val(industry).trigger('change'); // Use .trigger('change') to update the Select2 control
        $('#selectTrigger').val(trigger).trigger('change'); // Use .trigger('change') to update the Select2 control
        $('#selectStatus').val(status).trigger('change');
        $('#txtRevenue').val(revenue.toLocaleString('en-US', {
            style: 'currency',
            currency: 'USD',
            maximumFractionDigits: 0 // To ensure no decimal point
        }));

        $('#txtInsurance').val(insurance.toLocaleString('en-US', {
            style: 'currency',
            currency: 'USD',
            maximumFractionDigits: 0 // To ensure no decimal point
        }));

        $('#txtDeductable').val(deductable.toLocaleString('en-US', {
            style: 'currency',
            currency: 'USD',
            maximumFractionDigits: 0 // To ensure no decimal point
        }));


        // Send an AJAX request to get the matching scenarios
        $.ajax({
            url: '/OTRisk/get_scenarios/',
            data: {
                'raw_id': raw_id
            },
            dataType: 'json',

            success: function(scenarios) {

                  document.getElementById("scenarioCount").value = "1";

                  if (scenarios.length >= 2) {
                      document.getElementById("scenarioCount").value = "2";
                      document.getElementById("scenario2-tab").click();
                      document.getElementById("hdnScenarioID_2").value = scenarios[1].pk;
                      sessionStorage.setItem('scenario2id',scenarios[1].pk);
                      document.getElementById("txtScenarioDescription_2").value = scenarios[1].fields.ScenarioDescription;
                      document.getElementById("selectThreat_2").value = scenarios[1].fields.threatSource;
                      document.getElementById("selectTactics_2").value = scenarios[1].fields.threatTactic;
                      document.getElementById("selectOutage_2").value = scenarios[1].fields.outage;
                      document.getElementById("outage_2").value = scenarios[1].fields.outageLength;

                      document.getElementById("lblriskScore_2").value = scenarios[1].fields.RiskScore;
                      document.getElementById("lblriskRating_2").value = scenarios[1].fields.RiskStatus;
                      document.getElementById("lblriskSummary_2").value = scenarios[1].fields.riskSummary;
                      document.getElementById("lblriskCost_2").value = parseFloat(scenarios[1].fields.event_cost_low).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });
                         document.getElementById("lblriskCostHigh_2").value = parseFloat(scenarios[1].fields.event_cost_high).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                         document.getElementById("lblriskCostMedian_2").value = parseFloat(scenarios[1].fields.event_cost_median).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                      document.getElementById("range_safety_2").value = scenarios[1].fields.SafetyScore;
                      initSlider('range_safety_2', 'safetyrange_2')
                      document.getElementById("range_life_2").value = scenarios[1].fields.lifeScore;
                      initSlider('range_life_2', 'liferange_2')
                      document.getElementById("range_production_2").value = scenarios[1].fields.productionScore;
                      initSlider('range_production_2', 'productionrange_2')
                      document.getElementById("range_finance_2").value = scenarios[1].fields.FinancialScore;
                      initSlider('range_finance_1', 'financerange_2')
                      document.getElementById("range_reputation_2").value = scenarios[1].fields.ReputationScore;
                      initSlider('range_reputation_2', 'reputationrange_2')
                      document.getElementById("range_environment_2").value = scenarios[1].fields.environmentScore;
                      initSlider('range_environment_2', 'environmentrange_2')
                      document.getElementById("range_regulatory_2").value = scenarios[1].fields.regulatoryScore;
                      initSlider('range_regulatory_2', 'regulatoryrange_2')
                      document.getElementById("range_supply_2").value = scenarios[1].fields.supplyScore;
                      initSlider('range_supply_2', 'supplyrange_2')
                      document.getElementById("range_data_2").value = scenarios[1].fields.DataScore;
                      initSlider('range_data_2', 'datarange_2')
                      document.getElementById("range_vuln_2").value = scenarios[1].fields.VulnScore;
                      initSlider('range_vuln_2', 'vulnrange_2')
                      document.getElementById("range_threat_2").value = scenarios[1].fields.ThreatScore;
                      initSlider('range_threat_2', 'threatrange_2')
                      document.getElementById("txtAssets_2").value = scenarios[1].fields.notes;
                      document.getElementById("txtSafetyJustify_2").value = scenarios[1].fields.justifySafety;
                      document.getElementById("txtlifeJustify_2").value = scenarios[1].fields.justifyLife;
                      document.getElementById("txtproductionJustify_2").value = scenarios[1].fields.justifyProduction;
                      document.getElementById("txtfinanceJustify_2").value = scenarios[1].fields.justifyFinancial;
                      document.getElementById("txtreputationJustify_2").value = scenarios[1].fields.justifyReputation;
                      document.getElementById("txtenvironmentJustify_2").value = scenarios[1].fields.justifyEnvironment;
                      document.getElementById("txtregulationJustify_2").value = scenarios[1].fields.justifyRegulation;
                      document.getElementById("txtdataJustify_2").value = scenarios[1].fields.justifyData;
                      document.getElementById("txtsupplyJustify_2").value = scenarios[1].fields.justifySupply;

                      }
                  if (scenarios.length >= 3) {
                      document.getElementById("scenarioCount").value = "3";
                      document.getElementById("scenario3-tab").click();
                      document.getElementById("hdnScenarioID_3").value = scenarios[2].pk;
                      sessionStorage.setItem('scenario3id',scenarios[2].pk);
                      document.getElementById("txtScenarioDescription_3").value = scenarios[2].fields.ScenarioDescription;
                      document.getElementById("selectThreat_3").value = scenarios[2].fields.threatSource;
                      document.getElementById("selectTactics_3").value = scenarios[2].fields.threatTactic;
                      document.getElementById("selectOutage_3").value = scenarios[2].fields.outage;
                      document.getElementById("outage_3").value = scenarios[2].fields.outageLength;

                      document.getElementById("lblriskScore_3").value = scenarios[2].fields.RiskScore;
                     document.getElementById("lblriskRating_3").value = scenarios[2].fields.RiskStatus;
                     document.getElementById("lblriskSummary_3").value = scenarios[2].fields.riskSummary;
                      document.getElementById("lblriskCost_3").value = parseFloat(scenarios[2].fields.event_cost_low).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });
                         document.getElementById("lblriskCostHigh_3").value = parseFloat(scenarios[2].fields.event_cost_high).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                         document.getElementById("lblriskCostMedian_3").value = parseFloat(scenarios[2].fields.event_cost_median).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });


                      document.getElementById("range_safety_3").value = scenarios[2].fields.SafetyScore;
                      initSlider('range_safety_3', 'safetyrange_3')
                      document.getElementById("range_life_3").value = scenarios[2].fields.lifeScore;
                      initSlider('range_life_3', 'liferange_3')
                      document.getElementById("range_production_3").value = scenarios[2].fields.productionScore;
                      initSlider('range_production_3', 'productionrange_3')
                      document.getElementById("range_finance_3").value = scenarios[2].fields.FinancialScore;
                      initSlider('range_finance_3', 'financerange_3')
                      document.getElementById("range_reputation_3").value = scenarios[2].fields.ReputationScore;
                      initSlider('range_reputation_3', 'reputationrange_3')
                      document.getElementById("range_environment_3").value = scenarios[2].fields.environmentScore;
                      initSlider('range_environment_3', 'environmentrange_3')
                      document.getElementById("range_regulatory_3").value = scenarios[2].fields.regulatoryScore;
                      initSlider('range_regulatory_3', 'regulatoryrange_3')
                      document.getElementById("range_supply_3").value = scenarios[2].fields.supplyScore;
                      initSlider('range_supply_3', 'supplyrange_3')
                      document.getElementById("range_data_3").value = scenarios[2].fields.DataScore;
                      initSlider('range_data_3', 'datarange_3')
                      document.getElementById("range_vuln_3").value = scenarios[2].fields.VulnScore;
                      initSlider('range_vuln_3', 'vulnrange_3')
                      document.getElementById("range_threat_3").value = scenarios[2].fields.ThreatScore;
                      initSlider('range_threat_3', 'threatrange_3')
                      document.getElementById("txtAssets_3").value = scenarios[2].fields.notes;
                      document.getElementById("txtSafetyJustify_3").value = scenarios[2].fields.justifySafety;
                      document.getElementById("txtlifeJustify_3").value = scenarios[2].fields.justifyLife;
                      document.getElementById("txtproductionJustify_3").value = scenarios[2].fields.justifyProduction;
                      document.getElementById("txtfinanceJustify_3").value = scenarios[2].fields.justifyFinancial;
                      document.getElementById("txtreputationJustify_3").value = scenarios[2].fields.justifyReputation;
                      document.getElementById("txtenvironmentJustify_3").value = scenarios[2].fields.justifyEnvironment;
                      document.getElementById("txtregulationJustify_3").value = scenarios[2].fields.justifyRegulation;
                      document.getElementById("txtdataJustify_3").value = scenarios[2].fields.justifyData;
                      document.getElementById("txtsupplyJustify_3").value = scenarios[2].fields.justifySupply;
                      }
                  if (scenarios.length >= 4) {
                      document.getElementById("scenarioCount").value = "4";
                      document.getElementById("scenario4-tab").click();
                      document.getElementById("hdnScenarioID_4").value = scenarios[3].pk;
                      sessionStorage.setItem('scenario4id',scenarios[3].pk);
                      document.getElementById("txtScenarioDescription_4").value = scenarios[3].fields.ScenarioDescription;
                      document.getElementById("selectThreat_4").value = scenarios[3].fields.threatSource;
                      document.getElementById("selectTactics_4").value = scenarios[3].fields.threatTactic;
                      document.getElementById("selectOutage_4").value = scenarios[3].fields.outage;
                      document.getElementById("outage_4").value = scenarios[3].fields.outageLength;

                      document.getElementById("lblriskScore_4").value = scenarios[3].fields.RiskScore;
                     document.getElementById("lblriskRating_4").value = scenarios[3].fields.RiskStatus;
                     document.getElementById("lblriskSummary_4").value = scenarios[3].fields.riskSummary;
                      document.getElementById("lblriskCost_4").value = parseFloat(scenarios[3].fields.event_cost_low).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });
                         document.getElementById("lblriskCostHigh_4").value = parseFloat(scenarios[3].fields.event_cost_high).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                         document.getElementById("lblriskCostMedian_4").value = parseFloat(scenarios[3].fields.event_cost_median).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });


                      document.getElementById("range_safety_4").value = scenarios[3].fields.SafetyScore;
                      initSlider('range_safety_4', 'safetyrange_4')
                      document.getElementById("range_life_4").value = scenarios[3].fields.lifeScore;
                      initSlider('range_life_4', 'liferange_4')
                      document.getElementById("range_production_4").value = scenarios[3].fields.productionScore;
                      initSlider('range_production_4', 'productionrange_4')
                      document.getElementById("range_finance_4").value = scenarios[3].fields.FinancialScore;
                      initSlider('range_finance_4', 'financerange_4')
                      document.getElementById("range_reputation_4").value = scenarios[3].fields.ReputationScore;
                      initSlider('range_reputation_4', 'reputationrange_4')
                      document.getElementById("range_environment_4").value = scenarios[3].fields.environmentScore;
                      initSlider('range_environment_4', 'environmentrange_4')
                      document.getElementById("range_regulatory_4").value = scenarios[3].fields.regulatoryScore;
                      initSlider('range_regulatory_4', 'regulatoryrange_4')
                      document.getElementById("range_supply_4").value = scenarios[3].fields.supplyScore;
                      initSlider('range_supply_4', 'supplyrange_4')
                      document.getElementById("range_data_4").value = scenarios[3].fields.DataScore;
                      initSlider('range_data_4', 'datarange_4')
                      document.getElementById("range_vuln_4").value = scenarios[3].fields.VulnScore;
                      initSlider('range_vuln_4', 'vulnrange_4')
                      document.getElementById("range_threat_4").value = scenarios[3].fields.ThreatScore;
                      initSlider('range_threat_4', 'threatrange_4')
                      document.getElementById("txtAssets_4").value = scenarios[3].fields.notes;
                      document.getElementById("txtSafetyJustify_4").value = scenarios[3].fields.justifySafety;
                      document.getElementById("txtlifeJustify_4").value = scenarios[3].fields.justifyLife;
                      document.getElementById("txtproductionJustify_4").value = scenarios[3].fields.justifyProduction;
                      document.getElementById("txtfinanceJustify_4").value = scenarios[3].fields.justifyFinancial;
                      document.getElementById("txtreputationJustify_4").value = scenarios[3].fields.justifyReputation;
                      document.getElementById("txtenvironmentJustify_4").value = scenarios[3].fields.justifyEnvironment;
                      document.getElementById("txtregulationJustify_4").value = scenarios[3].fields.justifyRegulation;
                      document.getElementById("txtdataJustify_4").value = scenarios[3].fields.justifyData;
                      document.getElementById("txtsupplyJustify_4").value = scenarios[3].fields.justifySupply;
                      }
                  if (scenarios.length >= 5) {
                      document.getElementById("scenarioCount").value = "5";
                      document.getElementById("scenario5-tab").click();
                      document.getElementById("hdnScenarioID_5").value = scenarios[4].pk;
                      sessionStorage.setItem('scenario5id',scenarios[4].pk);
                      document.getElementById("txtScenarioDescription_5").value = scenarios[4].fields.ScenarioDescription;
                      document.getElementById("selectThreat_5").value = scenarios[4].fields.threatSource;
                      document.getElementById("selectTactics_5").value = scenarios[4].fields.threatTactic;
                      document.getElementById("selectOutage_5").value = scenarios[4].fields.outage;
                      document.getElementById("outage_5").value = scenarios[4].fields.outageLength;

                      document.getElementById("lblriskScore_5").value = scenarios[4].fields.RiskScore;
                      document.getElementById("lblriskRating_5").value = scenarios[4].fields.RiskStatus;
                      document.getElementById("lblriskSummary_5").value = scenarios[4].fields.riskSummary;
                      document.getElementById("lblriskCost_5").value = parseFloat(scenarios[4].fields.event_cost_low).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });
                         document.getElementById("lblriskCostHigh_5").value = parseFloat(scenarios[4].fields.event_cost_high).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                         document.getElementById("lblriskCostMedian_5").value = parseFloat(scenarios[4].fields.event_cost_median).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });


                      document.getElementById("range_safety_5").value = scenarios[4].fields.SafetyScore;
                      initSlider('range_safety_5', 'safetyrange_5')
                      document.getElementById("range_life_5").value = scenarios[4].fields.lifeScore;
                      initSlider('range_life_5', 'liferange_5')
                      document.getElementById("range_production_5").value = scenarios[4].fields.productionScore;
                      initSlider('range_production_5', 'productionrange_5')
                      document.getElementById("range_finance_5").value = scenarios[4].fields.FinancialScore;
                      initSlider('range_finance_5', 'financerange_5')
                      document.getElementById("range_reputation_5").value = scenarios[4].fields.ReputationScore;
                      initSlider('range_reputation_5', 'reputationrange_5')
                      document.getElementById("range_environment_5").value = scenarios[4].fields.environmentScore;
                      initSlider('range_environment_5', 'environmentrange_5')
                      document.getElementById("range_regulatory_5").value = scenarios[4].fields.regulatoryScore;
                      initSlider('range_regulatory_5', 'regulatoryrange_5')
                      document.getElementById("range_supply_5").value = scenarios[4].fields.supplyScore;
                      initSlider('range_supply_5', 'supplyrange_5')
                      document.getElementById("range_data_5").value = scenarios[4].fields.DataScore;
                      initSlider('range_data_5', 'datarange_5')
                      document.getElementById("range_vuln_5").value = scenarios[4].fields.VulnScore;
                      initSlider('range_vuln_5', 'vulnrange_5')
                      document.getElementById("range_threat_5").value = scenarios[4].fields.ThreatScore;
                      initSlider('range_threat_5', 'threatrange_5');
                      document.getElementById("txtAssets_5").value = scenarios[4].fields.notes;
                      document.getElementById("txtSafetyJustify_5").value = scenarios[4].fields.justifySafety;
                      document.getElementById("txtlifeJustify_5").value = scenarios[4].fields.justifyLife;
                      document.getElementById("txtproductionJustify_5").value = scenarios[4].fields.justifyProduction;
                      document.getElementById("txtfinanceJustify_5").value = scenarios[4].fields.justifyFinancial;
                      document.getElementById("txtreputationJustify_5").value = scenarios[4].fields.justifyReputation;
                      document.getElementById("txtenvironmentJustify_5").value = scenarios[4].fields.justifyEnvironment;
                      document.getElementById("txtregulationJustify_5").value = scenarios[4].fields.justifyRegulation;
                      document.getElementById("txtdataJustify_5").value = scenarios[4].fields.justifyData;
                      document.getElementById("txtsupplyJustify_5").value = scenarios[4].fields.justifySupply;
                      }
                try {
                    document.getElementById("scenario1-tab").click();
                     if (scenarios && scenarios.length > 0 && scenarios[0]) {
                         document.getElementById("hdnScenarioID_1").value = scenarios[0].pk;
                         sessionStorage.setItem('scenario1id', scenarios[0].pk);
                         document.getElementById("txtScenarioDescription_1").value = scenarios[0].fields.ScenarioDescription;
                         document.getElementById("selectThreat_1").value = scenarios[0].fields.threatSource;
                         document.getElementById("selectTactics_1").value = scenarios[0].fields.threatTactic;
                         document.getElementById("selectOutage_1").value = scenarios[0].fields.outage;
                         document.getElementById("outage_1").value = scenarios[0].fields.outageLength;
                         document.getElementById("lblriskScore_1").value = scenarios[0].fields.RiskScore;
                         document.getElementById("lblriskRating_1").value = scenarios[0].fields.RiskStatus;
                         document.getElementById("lblriskSummary_1").value = scenarios[0].fields.riskSummary;

                         document.getElementById("lblriskCost_1").value = parseFloat(scenarios[0].fields.event_cost_low).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });
                         document.getElementById("lblriskCostHigh_1").value = parseFloat(scenarios[0].fields.event_cost_high).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                         document.getElementById("lblriskCostMedian_1").value = parseFloat(scenarios[0].fields.event_cost_median).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0
                        });

                         document.getElementById("range_safety_1").value = scenarios[0].fields.SafetyScore;
                         initSlider('range_safety_1', 'safetyrange_1')
                         document.getElementById("range_life_1").value = scenarios[0].fields.lifeScore;
                         initSlider('range_life_1', 'liferange_1')
                         document.getElementById("range_production_1").value = scenarios[0].fields.productionScore;
                         initSlider('range_production_1', 'productionrange_1')
                         document.getElementById("range_finance_1").value = scenarios[0].fields.FinancialScore;
                         initSlider('range_finance_1', 'financerange_1')
                         document.getElementById("range_reputation_1").value = scenarios[0].fields.ReputationScore;
                         initSlider('range_reputation_1', 'reputationrange_1')
                         document.getElementById("range_environment_1").value = scenarios[0].fields.environmentScore;
                         initSlider('range_environment_1', 'environmentrange_1')
                         document.getElementById("range_regulatory_1").value = scenarios[0].fields.regulatoryScore;
                         initSlider('range_regulatory_1', 'regulatoryrange_1')
                         document.getElementById("range_supply_1").value = scenarios[0].fields.supplyScore;
                         initSlider('range_supply_1', 'supplyrange_1')
                         document.getElementById("range_data_1").value = scenarios[0].fields.DataScore;
                         initSlider('range_data_1', 'datarange_1')
                         document.getElementById("range_vuln_1").value = scenarios[0].fields.VulnScore;
                         initSlider('range_vuln_1', 'vulnrange_1')
                         document.getElementById("range_threat_1").value = scenarios[0].fields.ThreatScore;
                         initSlider('range_threat_1', 'threatrange_1');
                         document.getElementById("txtAssets_1").value = scenarios[0].fields.notes;
                         document.getElementById("txtSafetyJustify_1").value = scenarios[0].fields.justifySafety;
                         document.getElementById("txtlifeJustify_1").value = scenarios[0].fields.justifyLife;
                          document.getElementById("txtproductionJustify_1").value = scenarios[0].fields.justifyProduction;
                          document.getElementById("txtfinanceJustify_1").value = scenarios[0].fields.justifyFinancial;
                          document.getElementById("txtreputationJustify_1").value = scenarios[0].fields.justifyReputation;
                          document.getElementById("txtenvironmentJustify_1").value = scenarios[0].fields.justifyEnvironment;
                          document.getElementById("txtregulationJustify_1").value = scenarios[0].fields.justifyRegulation;
                          document.getElementById("txtdataJustify_1").value = scenarios[0].fields.justifyData;
                          document.getElementById("txtsupplyJustify_1").value = scenarios[0].fields.justifySupply;
                         //now load the action items table
                     } else {
                        console.warn("");
                     }

                    loadActions(raw_id)

                } catch (error){
                      console.error(error);
                }
                 }
        });
    });

});

function loadActions(rawID) {
    $.ajax({
        url: '/OTRisk/get_rawactions/',
        data: {
            'raw_id': rawID
        },
        dataType: 'json',
        success: function(actions) {
            // Clear existing rows
            $("#actiontable tbody").empty();

            // Populate table with new rows
            actions.forEach(function(action) {
                var row = '<tr>' +
                    '<td>' + action.ID + '</td>' +
                    '<td>' + action.actionTitle + '</td>' +
                    '<td>' + action.actionDescription + '</td>' +
                    '<td>' + action.actionStatus + '</td>' +
                    '<td>' + action.actionPriority + '</td>' +
                    '<td>' + action.actionOwner + '</td>' +
                    // Add more <td> elements for each field in the RAActions model
                    '</tr>';
                $("#actiontable tbody").append(row);
            });
        }
    });
}



function initFrequencySlider(sliderId, outputId) {
    var slider = document.getElementById(sliderId);
    var output = document.getElementById(outputId);

    switch (parseInt(slider.value)) {
        case 1:
            output.innerHTML = "New / Hardened";
            break;
        case 2:
            output.innerHTML = "New / Hardened";
            break;
        case 3:
            output.innerHTML = "Current / Managed";
            break;
        case 4:
            output.innerHTML = "Current / Managed";
            break;
        case 5:
            output.innerHTML = "Aging / Supported";
            break;
        case 6:
            output.innerHTML = "Aging / Supported";
            break;
        case 7:
            output.innerHTML = "Legacy / Unmanaged";
            break;
        case 8:
            output.innerHTML = "Legacy / Unmanaged";
            break;
        case 9:
            output.innerHTML = "Obselete";
            break;
        case 10:
            output.innerHTML = "Obselete";
            break;
    }
}


  function initSlider(sliderId, outputId) {
    var slider = document.getElementById(sliderId);
    var output = document.getElementById(outputId);

    // Display the default slider value
    output.innerHTML = getSeverityLabel(slider.value);

    // Update the current slider value (each time you drag the slider handle)
    slider.oninput = function() {
      output.innerHTML = getSeverityLabel(this.value);
      // calculateRiskScore();
    };
  }

  function getSeverityLabel(value) {
    switch (parseInt(value)) {
      case 1:
        case 2:
        return "Low";
      case 3:
        case 4:
        return "Low/Medium";
      case 5:
        case 6:
        return "Medium";
      case 7:
        case 8:
        return "Medium/High";
      case 9:
        case 10:
        return "High";
      default:
        return "";
    }
  }



    function clearValues(){

      document.getElementById("scenario2-tab").click();
      document.getElementById("hdnScenarioID_2").value = '';
      document.getElementById("txtScenarioDescription_2").value = '';
      document.getElementById("selectThreat_2").value = '';
      document.getElementById("selectTactics_2").value = '';
      document.getElementById("range_safety_2").value = 0;
      initSlider('range_safety_2', 'safetyrange_2')
      document.getElementById("range_life_2").value = 0;
      initSlider('range_life_2', 'liferange_2')
      document.getElementById("range_production_2").value = 0;
      initSlider('range_production_2', 'productionrange_2')
      document.getElementById("range_finance_2").value = 0;
      initSlider('range_finance_1', 'financerange_2')
      document.getElementById("range_reputation_2").value = 0;
      initSlider('range_reputation_2', 'reputationrange_2')
      document.getElementById("range_environment_2").value = 0;
      initSlider('range_environment_2', 'environmentrange_2')
      document.getElementById("range_regulatory_1").value = 0;
      initSlider('range_regulatory_2', 'regulatoryrange_2')
        document.getElementById("range_supply_1").value = 0;
      initSlider('range_supply_2', 'supplyrange_2')
      document.getElementById("range_data_2").value = 0;
      initSlider('range_data_2', 'datarange_2')
      document.getElementById("range_vuln_2").value = 0;
      initSlider('range_vuln_2', 'vulnrange_2')
      document.getElementById("range_threat_2").value = 0;
      initSlider('range_threat_2', 'threatrange_2')
      document.getElementById("txtAssets_2").value = '';
      document.getElementById("lblriskScore_2").value = '';
      document.getElementById("lblriskRating_2").value = '';
      document.getElementById("lblriskCost_2").value = '';
      document.getElementById("lblriskSummary_2").value = '';
      document.getElementById("selectOutage_2").value = '';
      document.getElementById("outage_2").value = 0;

      document.getElementById("scenarioCount").value = '';
      document.getElementById("scenario3-tab").click();
      document.getElementById("hdnScenarioID_3").value = 0;
      document.getElementById("txtScenarioDescription_3").value = '';
      document.getElementById("selectThreat_3").value = '';
      document.getElementById("selectTactics_3").value = '';
      document.getElementById("range_safety_3").value = 0;
      initSlider('range_safety_3', 'safetyrange_3')
      document.getElementById("range_life_3").value = 0;
      initSlider('range_life_3', 'liferange_3')
      document.getElementById("range_production_3").value = 0;
      initSlider('range_production_3', 'productionrange_3')
      document.getElementById("range_finance_3").value = 0;
      initSlider('range_finance_3', 'financerange_3')
      document.getElementById("range_reputation_3").value = 0;
      initSlider('range_reputation_3', 'reputationrange_3')
      document.getElementById("range_environment_3").value = 0;
      initSlider('range_environment_3', 'environmentrange_3')
      document.getElementById("range_regulatory_3").value = 0;
      initSlider('range_regulatory_3', 'regulatoryrange_3')
        document.getElementById("range_supply_3").value = 0;
      initSlider('range_supply_3', 'supplyrange_3')
      document.getElementById("range_data_3").value = 0;
      initSlider('range_data_3', 'datarange_3')
      document.getElementById("range_vuln_3").value = 0;
      initSlider('range_vuln_3', 'vulnrange_3')
      document.getElementById("range_threat_3").value = 0;
      initSlider('range_threat_3', 'threatrange_3')
      document.getElementById("txtAssets_3").value = '';
      document.getElementById("lblriskScore_3").value = '';
      document.getElementById("lblriskRating_3").value = '';
      document.getElementById("lblriskCost_3").value = '';
      document.getElementById("lblriskSummary_3").value = '';
      document.getElementById("selectOutage_3").value = '';
      document.getElementById("outage_3").value = 0;

      document.getElementById("scenarioCount").value = "";
      document.getElementById("scenario4-tab").click();
      document.getElementById("hdnScenarioID_4").value = 0;
      document.getElementById("txtScenarioDescription_4").value = '';
      document.getElementById("selectThreat_4").value = '';
      document.getElementById("selectTactics_4").value = '';
      document.getElementById("range_safety_4").value = 0;
      initSlider('range_safety_4', 'safetyrange_4')
      document.getElementById("range_life_4").value = 0;
      initSlider('range_life_4', 'liferange_4')
      document.getElementById("range_production_4").value = 0;
      initSlider('range_production_4', 'productionrange_4')
      document.getElementById("range_finance_4").value = 0;
      initSlider('range_finance_4', 'financerange_4')
      document.getElementById("range_reputation_4").value = 0;
      initSlider('range_reputation_4', 'reputationrange_4')
      document.getElementById("range_environment_4").value = 0;
      initSlider('range_environment_4', 'environmentrange_4')
      document.getElementById("range_regulatory_4").value = 0;
      initSlider('range_regulatory_4', 'regulatoryrange_4')
      document.getElementById("range_supply_4").value = 0;
      initSlider('range_supply_4', 'supplyrange_4')
      document.getElementById("range_data_4").value = 0;
      initSlider('range_data_4', 'datarange_4')
      document.getElementById("range_vuln_4").value = 0;
      initSlider('range_vuln_4', 'vulnrange_4')
      document.getElementById("range_threat_4").value = 0;
      initSlider('range_threat_4', 'threatrange_4')
      document.getElementById("txtAssets_4").value = '';
      document.getElementById("lblriskScore_4").value = '';
      document.getElementById("lblriskRating_4").value = '';
      document.getElementById("lblriskCost_4").value = '';
      document.getElementById("lblriskSummary_4").value = '';
      document.getElementById("selectOutage_4").value = '';
      document.getElementById("outage_4").value = 0;

      document.getElementById("scenarioCount").value = "";
      document.getElementById("scenario5-tab").click();
      document.getElementById("hdnScenarioID_5").value = '';
      document.getElementById("txtScenarioDescription_5").value = '';
      document.getElementById("selectThreat_5").value = '';
      document.getElementById("selectTactics_5").value = '';
      document.getElementById("selectOutage_5").value = '';
      document.getElementById("outage_5").value = 0;

      initSlider('range_safety_5', 'safetyrange_5')
      document.getElementById("range_life_5").value = 0;
      initSlider('range_life_5', 'liferange_5')
      document.getElementById("range_production_5").value = 0;
      initSlider('range_production_5', 'productionrange_5')
      document.getElementById("range_finance_5").value = 0;
      initSlider('range_finance_5', 'financerange_5')
      document.getElementById("range_reputation_5").value = 0;
      initSlider('range_reputation_5', 'reputationrange_5')
      document.getElementById("range_environment_5").value = 0;
      initSlider('range_environment_5', 'environmentrange_5')
      document.getElementById("range_regulatory_5").value = 0;
      initSlider('range_regulatory_5', 'regulatoryrange_5')
      document.getElementById("range_supply_5").value = 0;
      initSlider('range_supply_5', 'supplyrange_5')
      document.getElementById("range_data_5").value = 0;
      initSlider('range_data_5', 'datarange_5')
      document.getElementById("range_vuln_5").value = 0;
      initSlider('range_vuln_5', 'vulnrange_5')
      document.getElementById("range_threat_5").value = 0;
      initSlider('range_threat_5', 'threatrange_5')
      document.getElementById("txtAssets_5").value = '';
      document.getElementById("lblriskScore_5").value = '';
      document.getElementById("lblriskRating_5").value = '';
      document.getElementById("lblriskCost_5").value = '';
      document.getElementById("lblriskSummary_5").value = '';

      document.getElementById("scenario1-tab").click();
      document.getElementById("hdnScenarioID_1").value = '';
      document.getElementById("txtScenarioDescription_1").value = '';
      document.getElementById("selectThreat_1").value = '';
      document.getElementById("selectOutage_1").value = '';
      document.getElementById("outage_1").value = '';
      document.getElementById("selectTactics_1").value = '';
      document.getElementById("range_safety_1").value = 0;
      initSlider('range_safety_1', 'safetyrange_1')
      document.getElementById("range_life_1").value = 0;
      initSlider('range_life_1', 'liferange_1')
      document.getElementById("range_production_1").value = 0;
      initSlider('range_production_1', 'productionrange_1')
      document.getElementById("range_finance_1").value = 0;
      initSlider('range_finance_1', 'financerange_1')
      document.getElementById("range_reputation_1").value = 0;
      initSlider('range_reputation_1', 'reputationrange_1')
      document.getElementById("range_environment_1").value = 0;
      initSlider('range_environment_1', 'environmentrange_1')
      document.getElementById("range_regulatory_1").value = 0;
      initSlider('range_regulatory_1', 'regulatoryrange_1')
      document.getElementById("range_supply_1").value = 0;
      initSlider('range_supply_1', 'supplyrange_1')
      document.getElementById("range_data_1").value = 0;
      initSlider('range_data_1', 'datarange_1')
      document.getElementById("range_vuln_1").value = 0;
      initSlider('range_vuln_1', 'vulnrange_1')
      document.getElementById("range_threat_1").value = 0;
      initSlider('range_threat_1', 'threatrange_1')
      document.getElementById("txtAssets_1").value = '';
      document.getElementById("lblriskScore_1").value = '';
      document.getElementById("lblriskRating_1").value = '';
      document.getElementById("lblriskCost_1").value = '';
      document.getElementById("lblriskSummary_1").value = '';

    }

function setRiskAssessmentRefreshRequired(scenarioNumber) {
    sessionStorage.setItem('riskAssessmentRefreshRequired_' + scenarioNumber, '1');
}


function setRiskAssessmentRefreshNotRequired(scenarioNumber) {
    sessionStorage.setItem('riskAssessmentRefreshRequired_' + scenarioNumber, '0');
}

function checkRiskAssessmentRefreshVariables() {
    for (let i = 1; i <= 5; i++) {
        let value = sessionStorage.getItem('riskAssessmentRefreshRequired_' + i);
        if (value === '1') {
            alert('Changes have been made to Scenario ' + i + ' that are not reflected in the risk assessment score and estimated costs. Re-run the risk assessment before saving the worksheet.');
            return false; // This will prevent the form submission
        }
    }
    return true; // This will allow the form to be submitted
}




</script>

</body>
</html>